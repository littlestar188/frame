function Notification(e,t){CKEDITOR.tools.extend(this,t,{editor:e,id:"cke-"+CKEDITOR.tools.getUniqueId(),area:e._.notificationArea}),t.type||(this.type="info"),this.element=this._createElement(),e.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(this.element)}function Area(e){var t=this;this.editor=e,this.notifications=[],this.element=this._createElement(),this._uiBuffer=CKEDITOR.tools.eventsBuffer(10,this._layout,this),this._changeBuffer=CKEDITOR.tools.eventsBuffer(500,this._layout,this),e.on("destroy",function(){t._removeListeners(),t.element.remove()})}CKEDITOR.lang["zh-cn"]={wsc:{btnIgnore:"忽略",btnIgnoreAll:"全部忽略",btnReplace:"替换",btnReplaceAll:"全部替换",btnUndo:"撤消",changeTo:"更改为",errorLoading:"加载应该服务主机时出错: %s.",ieSpellDownload:"拼写检查插件还没安装, 您是否想现在就下载?",manyChanges:"拼写检查完成: 更改了 %1 个单词",noChanges:"拼写检查完成: 没有更改任何单词",noMispell:"拼写检查完成: 没有发现拼写错误",noSuggestions:"- 没有建议 -",notAvailable:"抱歉, 服务目前暂不可用",notInDic:"没有在字典里",oneChange:"拼写检查完成: 更改了一个单词",progress:"正在进行拼写检查...",title:"拼写检查",toolbar:"拼写检查"},undo:{redo:"重做",undo:"撤消"},toolbar:{toolbarCollapse:"折叠工具栏",toolbarExpand:"展开工具栏",toolbarGroups:{document:"文档",clipboard:"剪贴板/撤销",editing:"编辑",forms:"表单",basicstyles:"基本格式",paragraph:"段落",links:"链接",insert:"插入",styles:"样式",colors:"颜色",tools:"工具"},toolbars:"工具栏"},table:{border:"边框",caption:"标题",cell:{menu:"单元格",insertBefore:"在左侧插入单元格",insertAfter:"在右侧插入单元格",deleteCell:"删除单元格",merge:"合并单元格",mergeRight:"向右合并单元格",mergeDown:"向下合并单元格",splitHorizontal:"水平拆分单元格",splitVertical:"垂直拆分单元格",title:"单元格属性",cellType:"单元格类型",rowSpan:"纵跨行数",colSpan:"横跨列数",wordWrap:"自动换行",hAlign:"水平对齐",vAlign:"垂直对齐",alignBaseline:"基线",bgColor:"背景颜色",borderColor:"边框颜色",data:"数据",header:"表头",yes:"是",no:"否",invalidWidth:"单元格宽度必须为数字格式",invalidHeight:"单元格高度必须为数字格式",invalidRowSpan:"行跨度必须为整数格式",invalidColSpan:"列跨度必须为整数格式",chooseColor:"选择"},cellPad:"边距",cellSpace:"间距",column:{menu:"列",insertBefore:"在左侧插入列",insertAfter:"在右侧插入列",deleteColumn:"删除列"},columns:"列数",deleteTable:"删除表格",headers:"标题单元格",headersBoth:"第一列和第一行",headersColumn:"第一列",headersNone:"无",headersRow:"第一行",invalidBorder:"边框粗细必须为数字格式",invalidCellPadding:"单元格填充必须为数字格式",invalidCellSpacing:"单元格间距必须为数字格式",invalidCols:"指定的行数必须大于零",invalidHeight:"表格高度必须为数字格式",invalidRows:"指定的列数必须大于零",invalidWidth:"表格宽度必须为数字格式",menu:"表格属性",row:{menu:"行",insertBefore:"在上方插入行",insertAfter:"在下方插入行",deleteRow:"删除行"},rows:"行数",summary:"摘要",title:"表格属性",toolbar:"表格",widthPc:"百分比",widthPx:"像素",widthUnit:"宽度单位"},stylescombo:{label:"样式",panelTitle:"样式",panelTitle1:"块级元素样式",panelTitle2:"内联元素样式",panelTitle3:"对象元素样式"},specialchar:{options:"特殊符号选项",title:"选择特殊符号",toolbar:"插入特殊符号"},sourcearea:{toolbar:"源码"},scayt:{btn_about:"关于即时拼写检查",btn_dictionaries:"字典",btn_disable:"禁用即时拼写检查",btn_enable:"启用即时拼写检查",btn_langs:"语言",btn_options:"选项",text_title:"即时拼写检查"},removeformat:{toolbar:"清除格式"},pastetext:{button:"粘贴为无格式文本",title:"粘贴为无格式文本"},pastefromword:{confirmCleanup:"您要粘贴的内容好像是来自 MS Word，是否要清除 MS Word 格式后再粘贴？",error:"由于内部错误无法清理要粘贴的数据",title:"从 MS Word 粘贴",toolbar:"从 MS Word 粘贴"},maximize:{maximize:"全屏",minimize:"最小化"},magicline:{title:"在这插入段落"},list:{bulletedlist:"项目列表",numberedlist:"编号列表"},link:{acccessKey:"访问键",advanced:"高级",advisoryContentType:"内容类型",advisoryTitle:"标题",anchor:{toolbar:"插入/编辑锚点链接",menu:"锚点链接属性",title:"锚点链接属性",name:"锚点名称",errorName:"请输入锚点名称",remove:"删除锚点"},anchorId:"按锚点 ID",anchorName:"按锚点名称",charset:"字符编码",cssClasses:"样式类名称",download:"强制下载",displayText:"显示文本",emailAddress:"地址",emailBody:"内容",emailSubject:"主题",id:"ID",info:"超链接信息",langCode:"语言代码",langDir:"语言方向",langDirLTR:"从左到右 (LTR)",langDirRTL:"从右到左 (RTL)",menu:"编辑超链接",name:"名称",noAnchors:"(此文档没有可用的锚点)",noEmail:"请输入电子邮件地址",noUrl:"请输入超链接地址",other:"<其他>",popupDependent:"依附 (NS)",popupFeatures:"弹出窗口属性",popupFullScreen:"全屏 (IE)",popupLeft:"左",popupLocationBar:"地址栏",popupMenuBar:"菜单栏",popupResizable:"可缩放",popupScrollBars:"滚动条",popupStatusBar:"状态栏",popupToolbar:"工具栏",popupTop:"右",rel:"关联",selectAnchor:"选择一个锚点",styles:"行内样式",tabIndex:"Tab 键次序",target:"目标",targetFrame:"<框架>",targetFrameName:"目标框架名称",targetPopup:"<弹出窗口>",targetPopupName:"弹出窗口名称",title:"超链接",toAnchor:"页内锚点链接",toEmail:"电子邮件",toUrl:"地址",toolbar:"插入/编辑超链接",type:"超链接类型",unlink:"取消超链接",upload:"上传"},indent:{indent:"增加缩进量",outdent:"减少缩进量"},image:{alt:"替换文本",border:"边框大小",btnUpload:"上传到服务器",button2Img:"确定要把当前图像按钮转换为普通图像吗？",hSpace:"水平间距",img2Button:"确定要把当前图像改变为图像按钮吗？",infoTab:"图像信息",linkTab:"链接",lockRatio:"锁定比例",menu:"图像属性",resetSize:"原始尺寸",title:"图像属性",titleButton:"图像域属性",upload:"上传",urlMissing:"缺少图像源文件地址",vSpace:"垂直间距",validateBorder:"边框大小必须为整数格式",validateHSpace:"水平间距必须为整数格式",validateVSpace:"垂直间距必须为整数格式"},horizontalrule:{toolbar:"插入水平线"},format:{label:"格式",panelTitle:"格式",tag_address:"地址",tag_div:"段落(DIV)",tag_h1:"标题 1",tag_h2:"标题 2",tag_h3:"标题 3",tag_h4:"标题 4",tag_h5:"标题 5",tag_h6:"标题 6",tag_p:"普通",tag_pre:"已编排格式"},fakeobjects:{anchor:"锚点",flash:"Flash 动画",hiddenfield:"隐藏域",iframe:"IFrame",unknown:"未知对象"},elementspath:{eleLabel:"元素路径",eleTitle:"%1 元素"},contextmenu:{options:"快捷菜单选项"},clipboard:{copy:"复制",copyError:"您的浏览器安全设置不允许编辑器自动执行复制操作，请使用键盘快捷键(Ctrl/Cmd+C)来完成。",cut:"剪切",cutError:"您的浏览器安全设置不允许编辑器自动执行剪切操作，请使用键盘快捷键(Ctrl/Cmd+X)来完成。",paste:"粘贴",pasteArea:"粘贴区域",pasteMsg:"请使用键盘快捷键(<STRONG>Ctrl/Cmd+V</STRONG>)把内容粘贴到下面的方框里，再按 <STRONG>确定</STRONG>",securityMsg:"因为您的浏览器的安全设置原因，本编辑器不能直接访问您的剪贴板内容，你需要在本窗口重新粘贴一次。",title:"粘贴"},button:{selectedLabel:"已选中 %1 项"},blockquote:{toolbar:"块引用"},basicstyles:{bold:"加粗",italic:"倾斜",strike:"删除线",subscript:"下标",superscript:"上标",underline:"下划线"},about:{copy:"版权所有 &copy; $1。<br />保留所有权利。",dlgTitle:"关于 CKEditor",help:"访问 $1 以获取帮助。",moreInfo:"相关授权许可信息请访问我们的网站：",title:"关于 CKEditor",userGuide:"CKEditor 用户向导"},editor:"所见即所得编辑器",editorPanel:"所见即所得编辑器面板",common:{editorHelp:"按 ALT+0 获得帮助",browseServer:"浏览服务器",url:"URL",protocol:"协议",upload:"上传",uploadSubmit:"上传到服务器",image:"图像",flash:"Flash",form:"表单",checkbox:"复选框",radio:"单选按钮",textField:"单行文本",textarea:"多行文本",hiddenField:"隐藏域",button:"按钮",select:"列表/菜单",imageButton:"图像按钮",notSet:"<没有设置>",id:"ID",name:"名称",langDir:"语言方向",langDirLtr:"从左到右 (LTR)",langDirRtl:"从右到左 (RTL)",langCode:"语言代码",longDescr:"详细说明 URL",cssClass:"样式类名称",advisoryTitle:"标题",cssStyle:"行内样式",ok:"确定",cancel:"取消",close:"关闭",preview:"预览",resize:"拖拽以改变大小",generalTab:"常规",advancedTab:"高级",validateNumberFailed:"需要输入数字格式",confirmNewPage:"当前文档内容未保存，是否确认新建文档？",confirmCancel:"部分修改尚未保存，是否确认关闭对话框？",options:"选项",target:"目标窗口",targetNew:"新窗口 (_blank)",targetTop:"整页 (_top)",targetSelf:"本窗口 (_self)",targetParent:"父窗口 (_parent)",langDirLTR:"从左到右 (LTR)",langDirRTL:"从右到左 (RTL)",styles:"样式",cssClasses:"样式类",width:"宽度",height:"高度",align:"对齐方式",alignLeft:"左对齐",alignRight:"右对齐",alignCenter:"居中",alignJustify:"两端对齐",alignTop:"顶端",alignMiddle:"居中",alignBottom:"底部",alignNone:"无",invalidValue:"无效的值。",invalidHeight:"高度必须为数字格式",invalidWidth:"宽度必须为数字格式",invalidCssLength:"此“%1”字段的值必须为正数，可以包含或不包含一个有效的 CSS 长度单位(px, %, in, cm, mm, em, ex, pt 或 pc)",invalidHtmlLength:"此“%1”字段的值必须为正数，可以包含或不包含一个有效的 HTML 长度单位(px 或 %)",invalidInlineStyle:"内联样式必须为格式是以分号分隔的一个或多个“属性名 : 属性值”。",cssLengthTooltip:"输入一个表示像素值的数字，或加上一个有效的 CSS 长度单位(px, %, in, cm, mm, em, ex, pt 或 pc)。",unavailable:'%1<span class="cke_accessibility">，不可用</span>',keyboard:{8:"退格键",13:"回车键",16:"Shift",17:"Ctrl",18:"Alt",32:"空格键",35:"行尾键",36:"行首键",46:"删除键",224:"Command"},keyboardShortcut:"快捷键"}},function(){CKEDITOR.plugins.add("uploadimage",{requires:"uploadwidget",onLoad:function(){CKEDITOR.addCss(".cke_upload_uploading img{opacity: 0.3}")},init:function(t){if(CKEDITOR.plugins.clipboard.isFileApiSupported){var i=CKEDITOR.fileTools,n=i.getUploadUrl(t.config,"image");n?(i.addUploadWidget(t,"uploadimage",{supportedTypes:/image\/(jpeg|png|gif|bmp)/,uploadUrl:n,fileToElement:function(){var t=new CKEDITOR.dom.element("img");return t.setAttribute("src",e),t},parts:{img:"img"},onUploading:function(e){this.parts.img.setAttribute("src",e.data)},onUploaded:function(e){var t=this.parts.img.$;this.replaceWith('<img src="'+e.url+'" width="'+(e.responseData.width||t.naturalWidth)+'" height="'+(e.responseData.height||t.naturalHeight)+'">')}}),t.on("paste",function(e){if(e.data.dataValue.match(/<img[\s\S]+data:/i)){e=e.data;var a,s,o,r=document.implementation.createHTMLDocument(""),r=new CKEDITOR.dom.element(r.body);for(r.data("cke-editable",1),r.appendHtml(e.dataValue),a=r.find("img"),o=0;o<a.count();o++){s=a.getItem(o);var l=s.getAttribute("src")&&"data:"==s.getAttribute("src").substring(0,5),d=null===s.data("cke-realelement");l&&d&&!s.data("cke-upload-id")&&!s.isReadOnly(1)&&(l=t.uploadRepository.create(s.getAttribute("src")),l.upload(n),i.markElement(s,"uploadimage",l.id),i.bindNotifications(t,l))}e.dataValue=r.getHtml()}})):CKEDITOR.error("uploadimage-config")}}});var e="data:image/gif;base64,R0lGODlhDgAOAIAAAAAAAP///yH5BAAAAAAALAAAAAAOAA4AAAIMhI+py+0Po5y02qsKADs="}(),function(){function e(e){function n(){this.deflated||(e.widgets.focused==this.widget&&(this.focused=!0),e.widgets.destroy(this.widget),this.deflated=!0)}function a(){var t=e.editable(),i=e.document;if(this.deflated)this.widget=e.widgets.initOn(this.element,"image",this.widget.data),this.widget.inline&&!new CKEDITOR.dom.elementPath(this.widget.wrapper,t).block&&(t=i.createElement(e.activeEnterMode==CKEDITOR.ENTER_P?"p":"div"),t.replace(this.widget.wrapper),this.widget.wrapper.move(t)),this.focused&&(this.widget.focus(),delete this.focused),delete this.deflated;else{var n=this.widget,t=o,i=n.wrapper,a=n.data.align,n=n.data.hasCaption;if(t){for(var s=3;s--;)i.removeClass(t[s]);"center"==a?n&&i.addClass(t[1]):"none"!=a&&i.addClass(t[p[a]])}else"center"==a?(n?i.setStyle("text-align","center"):i.removeStyle("text-align"),i.removeStyle("float")):("none"==a?i.removeStyle("float"):i.setStyle("float",a),i.removeStyle("text-align"))}}var o=e.config.image2_alignClasses,r=e.config.image2_captionedClass;return{allowedContent:d(e),requiredContent:"img[src,alt]",features:c(e),styleableElements:"img figure",contentTransformations:[["img[width]: sizeToAttribute"]],editables:{caption:{selector:"figcaption",allowedContent:"br em strong sub sup u s; a[!href,target]"}},parts:{image:"img",caption:"figcaption"},dialog:"image2",template:'<img alt="" src="" />',data:function(){var t=this.features;if(this.data.hasCaption&&!e.filter.checkFeature(t.caption)&&(this.data.hasCaption=!1),"none"==this.data.align||e.filter.checkFeature(t.align)||(this.data.align="none"),this.shiftState({widget:this,element:this.element,oldData:this.oldData,newData:this.data,deflate:n,inflate:a}),this.data.link?this.parts.link||(this.parts.link=this.parts.image.getParent()):this.parts.link&&delete this.parts.link,this.parts.image.setAttributes({src:this.data.src,"data-cke-saved-src":this.data.src,alt:this.data.alt}),this.oldData&&!this.oldData.hasCaption&&this.data.hasCaption)for(var i in this.data.classes)this.parts.image.removeClass(i);if(e.filter.checkFeature(t.dimension)){t=this.data,t={width:t.width,height:t.height},i=this.parts.image;for(var s in t)t[s]?i.setAttribute(s,t[s]):i.removeAttribute(s)}this.oldData=CKEDITOR.tools.extend({},this.data)},init:function(){var t=CKEDITOR.plugins.image2,i=this.parts.image,n={hasCaption:!!this.parts.caption,src:i.getAttribute("src"),alt:i.getAttribute("alt")||"",width:i.getAttribute("width")||"",height:i.getAttribute("height")||"",lock:!this.ready||t.checkHasNaturalRatio(i)},a=i.getAscendant("a");a&&this.wrapper.contains(a)&&(this.parts.link=a),n.align||(i=n.hasCaption?this.element:i,o?(i.hasClass(o[0])?n.align="left":i.hasClass(o[2])&&(n.align="right"),n.align?i.removeClass(o[p[n.align]]):n.align="none"):(n.align=i.getStyle("float")||"none",i.removeStyle("float"))),e.plugins.link&&this.parts.link&&(n.link=t.getLinkAttributesParser()(e,this.parts.link),(i=n.link.advanced)&&i.advCSSClasses&&(i.advCSSClasses=CKEDITOR.tools.trim(i.advCSSClasses.replace(/cke_\S+/,"")))),this.wrapper[(n.hasCaption?"remove":"add")+"Class"]("cke_image_nocaption"),this.setData(n),e.filter.checkFeature(this.features.dimension)&&!0!==e.config.image2_disableResizer&&s(this),this.shiftState=t.stateShifter(this.editor),this.on("contextMenu",function(e){e.data.image=CKEDITOR.TRISTATE_OFF,(this.parts.link||this.wrapper.getAscendant("a"))&&(e.data.link=e.data.unlink=CKEDITOR.TRISTATE_OFF)}),this.on("dialog",function(e){e.data.widget=this},this)},addClass:function(e){u(this).addClass(e)},hasClass:function(e){return u(this).hasClass(e)},removeClass:function(e){u(this).removeClass(e)},getClasses:function(){var e=new RegExp("^("+[].concat(r,o).join("|")+")$");return function(){var t,i=this.repository.parseElementClasses(u(this).getAttribute("class"));for(t in i)e.test(t)&&delete i[t];return i}}(),upcast:t(e),downcast:i(e),getLabel:function(){return this.editor.lang.widget.label.replace(/%1/,(this.data.alt||"")+" "+this.pathName)}}}function t(e){var t=n(e),i=e.config.image2_captionedClass;return function(e,n){var s,o={width:1,height:1},r=e.name;if(!e.attributes["data-cke-realelement"]&&(t(e)?("div"==r&&(s=e.getFirst("figure"))&&(e.replaceWith(s),e=s),n.align="center",s=e.getFirst("img")||e.getFirst("a").getFirst("img")):"figure"==r&&e.hasClass(i)?s=e.getFirst("img")||e.getFirst("a").getFirst("img"):a(e)&&(s="a"==e.name?e.children[0]:e),s)){for(var l in o)(o=s.attributes[l])&&o.match(g)&&delete s.attributes[l];return e}}}function i(e){var t=e.config.image2_alignClasses;return function(e){var i="a"==e.name?e.getFirst():e,n=i.attributes,a=this.data.align;if(!this.inline){var s=e.getFirst("span");s&&s.replaceWith(s.getFirst({img:1,a:1}))}return a&&"none"!=a&&(s=CKEDITOR.tools.parseCssText(n.style||""),"center"==a&&"figure"==e.name?e=e.wrapWith(new CKEDITOR.htmlParser.element("div",t?{class:t[1]}:{style:"text-align:center"})):a in{left:1,right:1}&&(t?i.addClass(t[p[a]]):s.float=a),t||CKEDITOR.tools.isEmpty(s)||(n.style=CKEDITOR.tools.writeCssText(s))),e}}function n(e){var t=e.config.image2_captionedClass,i=e.config.image2_alignClasses,n={figure:1,a:1,img:1};return function(s){if(!(s.name in{div:1,p:1}))return!1;var o=s.children;if(1!==o.length)return!1;if(o=o[0],!(o.name in n))return!1;if("p"==s.name){if(!a(o))return!1}else if("figure"==o.name){if(!o.hasClass(t))return!1}else if(e.enterMode==CKEDITOR.ENTER_P||!a(o))return!1;return!(i?!s.hasClass(i[1]):"center"!=CKEDITOR.tools.parseCssText(s.attributes.style||"",!0)["text-align"])}}function a(e){return"img"==e.name||"a"==e.name&&(1==e.children.length&&e.getFirst("img"))}function s(e){var t=e.editor,i=t.editable(),n=t.document,a=e.resizer=n.createElement("span");if(a.addClass("cke_image_resizer"),a.setAttribute("title",t.lang.image2.resizer),a.append(new CKEDITOR.dom.text("​",n)),e.inline)e.wrapper.append(a);else{var s=e.parts.link||e.parts.image,o=s.getParent(),r=n.createElement("span");r.addClass("cke_image_resizer_wrapper"),r.append(s),r.append(a),e.element.append(r,!0),o.is("span")&&o.remove()}a.on("mousedown",function(s){function o(e,t,i){var a=CKEDITOR.document,s=[];if(n.equals(a)||s.push(a.on(e,t)),s.push(n.on(e,t)),i)for(e=s.length;e--;)i.push(s.pop())}function r(){c=v+E*p,u=Math.round(c/b)}function l(){u=w-g,c=Math.round(u*b)}var d,c,u,h,p,g,f,m=e.parts.image,E="right"==e.data.align?-1:1,C=s.data.$.screenX,T=s.data.$.screenY,v=m.$.clientWidth,w=m.$.clientHeight,b=v/w,R=[],_="cke_image_s"+(~E?"e":"w");t.fire("saveSnapshot"),o("mousemove",function(e){d=e.data.$,p=d.screenX-C,g=T-d.screenY,f=Math.abs(p/g),1==E?0>=p?0>=g?r():f>=b?r():l():0>=g?f>=b?l():r():l():0>=p?0>=g?f>=b?l():r():l():0>=g?r():f>=b?r():l(),15<=c&&15<=u?(m.setAttributes({width:c,height:u}),h=!0):h=!1},R),o("mouseup",function(){for(var n;n=R.pop();)n.removeListener();i.removeClass(_),a.removeClass("cke_image_resizing"),h&&(e.setData({width:c,height:u}),t.fire("saveSnapshot")),h=!1},R),i.addClass(_),a.addClass("cke_image_resizing")}),e.on("data",function(){a["right"==e.data.align?"addClass":"removeClass"]("cke_image_resizer_left")})}function o(e){var t,i=[];return function(n){var a=e.getCommand("justify"+n);a&&(i.push(function(){a.refresh(e,e.elementPath())}),n in{right:1,left:1,center:1}&&a.on("exec",function(t){var a=l(e);if(a){for(a.setData("align",n),a=i.length;a--;)i[a]();t.cancel()}}),a.on("refresh",function(i){var a=l(e),s={right:1,left:1,center:1};a&&(void 0===t&&(t=e.filter.checkFeature(e.widgets.registered.image.features.align)),t?this.setState(a.data.align==n?CKEDITOR.TRISTATE_ON:n in s?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED):this.setState(CKEDITOR.TRISTATE_DISABLED),i.cancel())}))}}function r(e){e.plugins.link&&(CKEDITOR.on("dialogDefinition",function(t){if(t=t.data,"link"==t.name){t=t.definition;var i=t.onShow,n=t.onOk;t.onShow=function(){var t=l(e),n=this.getContentElement("info","linkDisplayText").getElement().getParent().getParent();t&&(t.inline?!t.wrapper.getAscendant("a"):1)?(this.setupContent(t.data.link||{}),n.hide()):(n.show(),i.apply(this,arguments))},t.onOk=function(){var t=l(e);if(t&&(t.inline?!t.wrapper.getAscendant("a"):1)){var i={};this.commitContent(i),t.setData("link",i)}else n.apply(this,arguments)}}}),e.getCommand("unlink").on("exec",function(t){var i=l(e);i&&i.parts.link&&(i.setData("link",null),this.refresh(e,e.elementPath()),t.cancel())}),e.getCommand("unlink").on("refresh",function(t){var i=l(e);i&&(this.setState(i.data.link||i.wrapper.getAscendant("a")?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),t.cancel())}))}function l(e){return(e=e.widgets.focused)&&"image"==e.name?e:null}function d(e){var t=e.config.image2_alignClasses;return e={div:{match:n(e)},p:{match:n(e)},img:{attributes:"!src,alt,width,height"},figure:{classes:"!"+e.config.image2_captionedClass},figcaption:!0},t?(e.div.classes=t[1],e.p.classes=e.div.classes,e.img.classes=t[0]+","+t[2],e.figure.classes+=","+e.img.classes):(e.div.styles="text-align",e.p.styles="text-align",e.img.styles="float",e.figure.styles="float,display"),e}function c(e){return e=e.config.image2_alignClasses,{dimension:{requiredContent:"img[width,height]"},align:{requiredContent:"img"+(e?"("+e[0]+")":"{float}")},caption:{requiredContent:"figcaption"}}}function u(e){return e.data.hasCaption?e.element:e.parts.image}var h=new CKEDITOR.template('<figure class="{captionedClass}"><img alt="" src="" /><figcaption>{captionPlaceholder}</figcaption></figure>'),p={left:0,center:1,right:2},g=/^\s*(\d+\%)\s*$/i;CKEDITOR.plugins.add("image2",{lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",requires:"widget,dialog",icons:"image",hidpi:!0,onLoad:function(){CKEDITOR.addCss(".cke_image_nocaption{line-height:0}.cke_editable.cke_image_sw, .cke_editable.cke_image_sw *{cursor:sw-resize !important}.cke_editable.cke_image_se, .cke_editable.cke_image_se *{cursor:se-resize !important}.cke_image_resizer{display:none;position:absolute;width:10px;height:10px;bottom:-5px;right:-5px;background:#000;outline:1px solid #fff;line-height:0;cursor:se-resize;}.cke_image_resizer_wrapper{position:relative;display:inline-block;line-height:0;}.cke_image_resizer.cke_image_resizer_left{right:auto;left:-5px;cursor:sw-resize;}.cke_widget_wrapper:hover .cke_image_resizer,.cke_image_resizer.cke_image_resizing{display:block}.cke_widget_wrapper>a{display:inline-block}")},init:function(t){var i=t.config,n=t.lang.image2,a=e(t);i.filebrowserImage2BrowseUrl=i.filebrowserImageBrowseUrl,i.filebrowserImage2UploadUrl=i.filebrowserImageUploadUrl,a.pathName=n.pathName,a.editables.caption.pathName=n.pathNameCaption,t.widgets.add("image",a),t.ui.addButton&&t.ui.addButton("Image",{label:t.lang.common.image,command:"image",toolbar:"insert,10"}),t.contextMenu&&(t.addMenuGroup("image",10),t.addMenuItem("image",{label:n.menu,command:"image",group:"image"})),CKEDITOR.dialog.add("image2",this.path+"dialogs/image2.js")},afterInit:function(e){var t,i={left:1,right:1,center:1,block:1},n=o(e);for(t in i)n(t);r(e)}}),CKEDITOR.plugins.image2={stateShifter:function(e){function t(e,t){var s={};return a?s.attributes={class:a[1]}:s.styles={"text-align":"center"},s=n.createElement(e.activeEnterMode==CKEDITOR.ENTER_P?"p":"div",s),i(s,t),t.move(s),s}function i(t,i){if(i.getParent()){var n=e.createRange();n.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i.remove(),o.insertElementIntoRange(t,n)}else t.replace(i)}var n=e.document,a=e.config.image2_alignClasses,s=e.config.image2_captionedClass,o=e.editable(),r=["hasCaption","align","link"],l={align:function(i,n,s){var o=i.element;i.changed.align?i.newData.hasCaption||("center"==s&&(i.deflate(),i.element=t(e,o)),i.changed.hasCaption||"center"!=n||"center"==s||(i.deflate(),n=o.findOne("a,img"),n.replace(o),i.element=n)):"center"==s&&i.changed.hasCaption&&!i.newData.hasCaption&&(i.deflate(),i.element=t(e,o)),!a&&o.is("figure")&&("center"==s?o.setStyle("display","inline-block"):o.removeStyle("display"))},hasCaption:function(t,a,o){t.changed.hasCaption&&(a=t.element.is({img:1,a:1})?t.element:t.element.findOne("a,img"),t.deflate(),o?(o=CKEDITOR.dom.element.createFromHtml(h.output({captionedClass:s,captionPlaceholder:e.lang.image2.captionPlaceholder}),n),i(o,t.element),a.replace(o.findOne("img")),t.element=o):(a.replace(t.element),t.element=a))},link:function(t,i,a){if(t.changed.link){var s,o=t.element.is("img")?t.element:t.element.findOne("img"),r=t.element.is("a")?t.element:t.element.findOne("a"),l=t.element.is("a")&&!a||t.element.is("img")&&a;l&&t.deflate(),a?(i||(s=n.createElement("a",{attributes:{href:t.newData.link.url}}),s.replace(o),o.move(s)),a=CKEDITOR.plugins.image2.getLinkAttributesGetter()(e,a),CKEDITOR.tools.isEmpty(a.set)||(s||r).setAttributes(a.set),a.removed.length&&(s||r).removeAttributes(a.removed)):(a=r.findOne("img"),a.replace(r),s=a),l&&(t.element=s)}}};return function(e){var t,i;for(e.changed={},i=0;i<r.length;i++)t=r[i],e.changed[t]=!!e.oldData&&e.oldData[t]!==e.newData[t];for(i=0;i<r.length;i++)t=r[i],l[t](e,e.oldData?e.oldData[t]:null,e.newData[t]);e.inflate()}},checkHasNaturalRatio:function(e){var t=e.$;return e=this.getNatural(e),Math.round(t.clientWidth/e.width*e.height)==t.clientHeight||Math.round(t.clientHeight/e.height*e.width)==t.clientWidth},getNatural:function(e){if(e.$.naturalWidth)e={width:e.$.naturalWidth,height:e.$.naturalHeight};else{var t=new Image;t.src=e.getAttribute("src"),e={width:t.width,height:t.height}}return e},getLinkAttributesGetter:function(){return CKEDITOR.plugins.link.getLinkAttributes},getLinkAttributesParser:function(){return CKEDITOR.plugins.link.parseLinkAttributes}}}(),CKEDITOR.config.image2_captionedClass="image",function(){function e(e){this.editor=e,this.registered={},this.instances={},this.selected=[],this.widgetHoldingFocusedEditable=this.focused=null,this._={nextId:0,upcasts:[],upcastCallbacks:[],filters:{}},b(this),w(this),this.on("checkWidgets",o),this.editor.on("contentDomInvalidated",this.checkWidgets,this),v(this),E(this),C(this),m(this),T(this)}function t(e,i,n,a,s){var o=e.editor;CKEDITOR.tools.extend(this,a,{editor:o,id:i,inline:"span"==n.getParent().getName(),element:n,data:CKEDITOR.tools.extend({},"function"==typeof a.defaults?a.defaults():a.defaults),dataReady:!1,inited:!1,ready:!1,edit:t.prototype.edit,focusedEditable:null,definition:a,repository:e,draggable:!1!==a.draggable,_:{downcastFn:a.downcast&&"string"==typeof a.downcast?a.downcasts[a.downcast]:a.downcast}},!0),e.fire("instanceCreated",this),P(this,a),this.init&&this.init(),this.inited=!0,(e=this.element.data("cke-widget-data"))&&this.setData(JSON.parse(decodeURIComponent(e))),s&&this.setData(s),this.data.classes||this.setData("classes",this.getClasses()),this.dataReady=!0,U(this),this.fire("data",this.data),this.isInited()&&o.editable().contains(this.wrapper)&&(this.ready=!0,this.fire("ready"))}function i(e,t,i){CKEDITOR.dom.element.call(this,t.$),this.editor=e,this._={},t=this.filter=i.filter,CKEDITOR.dtd[this.getName()].p?(this.enterMode=t?t.getAllowedEnterMode(e.enterMode):e.enterMode,this.shiftEnterMode=t?t.getAllowedEnterMode(e.shiftEnterMode,!0):e.shiftEnterMode):this.enterMode=this.shiftEnterMode=CKEDITOR.ENTER_BR}function n(e,t){e.addCommand(t.name,{exec:function(e,i){function n(){e.widgets.finalizeCreation(r)}var a=e.widgets.focused;if(a&&a.name==t.name)a.edit();else if(t.insert)t.insert();else if(t.template){var s,a="function"==typeof t.defaults?t.defaults():t.defaults,a=CKEDITOR.dom.element.createFromHtml(t.template.output(a)),o=e.widgets.wrapElement(a,t.name),r=new CKEDITOR.dom.documentFragment(o.getDocument());r.append(o),(s=e.widgets.initOn(a,t,i&&i.startupData))?(a=s.once("edit",function(t){t.data.dialog?s.once("dialog",function(t){t=t.data;var i,a;i=t.once("ok",n,null,null,20),a=t.once("cancel",function(t){t.data&&!1===t.data.hide||e.widgets.destroy(s,!0)}),t.once("hide",function(){i.removeListener(),a.removeListener()})}):n()},null,null,999),s.edit(),a.removeListener()):n()}},allowedContent:t.allowedContent,requiredContent:t.requiredContent,contentForms:t.contentForms,contentTransformations:t.contentTransformations})}function a(e,t){function i(t,i,n){var a=CKEDITOR.tools.getIndex(e._.upcasts,function(e){return e[2]>n});0>a&&(a=e._.upcasts.length),e._.upcasts.splice(a,0,[t,i,n])}var n=t.upcast,a=t.upcastPriority||10;if(n)if("string"==typeof n)for(n=n.split(",");n.length;)i(t.upcasts[n.pop()],t.name,a);else i(n,t.name,a)}function s(e,t){if(e.focused=null,t.isInited()){var i=t.editor.checkDirty();e.fire("widgetBlurred",{widget:t}),t.setFocused(!1),!i&&t.editor.resetDirty()}}function o(e){if(e=e.data,"wysiwyg"==this.editor.mode){var i,n,a,s,o=this.editor.editable(),r=this.instances;if(o){for(i in r)r[i].isReady()&&!o.contains(r[i].wrapper)&&this.destroy(r[i],!0);if(e&&e.initOnlyNew)r=this.initOnAll();else{var l=o.find(".cke_widget_wrapper"),r=[];for(i=0,n=l.count();i<n;i++){if(a=l.getItem(i),s=!this.getByElement(a,!0)){e:{s=h;for(var d=a;d=d.getParent();)if(s(d)){s=!0;break e}s=!1}s=!s}s&&o.contains(a)&&(a.addClass("cke_widget_new"),r.push(this.initOn(a.getFirst(t.isDomWidgetElement))))}}e&&e.focusInited&&1==r.length&&r[0].focus()}}}function r(e,t,i){if(!i.allowedContent)return null;var n=this._.filters[e];return n||(this._.filters[e]=n={}),(e=n[t])||(n[t]=e=new CKEDITOR.filter(i.allowedContent)),e}function l(e){var i=[],n=e._.upcasts,a=e._.upcastCallbacks;return{toBeWrapped:i,iterator:function(e){var s,o,r,l,d;if("data-cke-widget-wrapper"in e.attributes)return(e=e.getFirst(t.isParserWidgetElement))&&i.push([e]),!1;if("data-widget"in e.attributes)return i.push([e]),!1;if(d=n.length){if(e.attributes["data-cke-widget-upcasted"])return!1;for(l=0,s=a.length;l<s;++l)if(!1===a[l](e))return;for(l=0;l<d;++l)if(s=n[l],r={},o=s[0](e,r))return o instanceof CKEDITOR.htmlParser.element&&(e=o),e.attributes["data-cke-widget-data"]=encodeURIComponent(JSON.stringify(r)),e.attributes["data-cke-widget-upcasted"]=1,i.push([e,s[1]]),!1}}}}function d(e,t){return{tabindex:-1,contenteditable:"false","data-cke-widget-wrapper":1,"data-cke-filter":"off",class:"cke_widget_wrapper cke_widget_new cke_widget_"+(e?"inline":"block")+(t?" cke_widget_"+t:"")}}function c(e,t,i){if(e.type==CKEDITOR.NODE_ELEMENT){var n=CKEDITOR.dtd[e.name];if(n&&!n[i.name]){var n=e.split(t),a=e.parent;return t=n.getIndex(),e.children.length||(--t,e.remove()),n.children.length||n.remove(),c(a,t,i)}}e.add(i,t)}function u(e,t){return"boolean"==typeof e.inline?e.inline:!!CKEDITOR.dtd.$inline[t]}function h(e){return e.hasAttribute("data-cke-temp")}function p(e,t,i,n){var a=e.editor;a.fire("lockSnapshot"),i?(n=i.data("cke-widget-editable"),n=t.editables[n],e.widgetHoldingFocusedEditable=t,t.focusedEditable=n,i.addClass("cke_widget_editable_focused"),n.filter&&a.setActiveFilter(n.filter),a.setActiveEnterMode(n.enterMode,n.shiftEnterMode)):(n||t.focusedEditable.removeClass("cke_widget_editable_focused"),t.focusedEditable=null,e.widgetHoldingFocusedEditable=null,a.setActiveFilter(null),a.setActiveEnterMode(null,null)),a.fire("unlockSnapshot")}function g(e){e.contextMenu&&e.contextMenu.addListener(function(t){if(t=e.widgets.getByElement(t,!0))return t.fire("contextMenu",{})})}function f(e,t){return CKEDITOR.tools.trim(t)}function m(e){var i=e.editor,n=CKEDITOR.plugins.lineutils;i.on("dragstart",function(n){var a=n.data.target;t.isDomDragHandler(a)&&(a=e.getByElement(a),n.data.dataTransfer.setData("cke/widget-id",a.id),i.focus(),a.focus())}),i.on("drop",function(t){var n=t.data.dataTransfer,a=n.getData("cke/widget-id"),s=n.getTransferType(i),n=i.createRange();""!==a&&s===CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?t.cancel():""!==a&&s==CKEDITOR.DATA_TRANSFER_INTERNAL&&(a=e.instances[a])&&(n.setStartBefore(a.wrapper),n.setEndAfter(a.wrapper),t.data.dragRange=n,delete CKEDITOR.plugins.clipboard.dragStartContainerChildCount,delete CKEDITOR.plugins.clipboard.dragEndContainerChildCount,t.data.dataTransfer.setData("text/html",i.editable().getHtmlFromRange(n).getHtml()),i.widgets.destroy(a,!0))}),i.on("contentDom",function(){var a=i.editable();CKEDITOR.tools.extend(e,{finder:new n.finder(i,{lookups:{default:function(i){if(!i.is(CKEDITOR.dtd.$listItem)&&i.is(CKEDITOR.dtd.$block)&&!t.isDomNestedEditable(i)&&!e._.draggedWidget.wrapper.contains(i)){var n=t.getNestedEditable(a,i);if(n){if(i=e._.draggedWidget,e.getByElement(n)==i)return;if(n=CKEDITOR.filter.instances[n.data("cke-filter")],i=i.requiredContent,n&&i&&!n.check(i))return}return CKEDITOR.LINEUTILS_BEFORE|CKEDITOR.LINEUTILS_AFTER}}}}),locator:new n.locator(i),liner:new n.liner(i,{lineStyle:{cursor:"move !important","border-top-color":"#666"},tipLeftStyle:{"border-left-color":"#666"},tipRightStyle:{"border-right-color":"#666"}})},!0)})}function E(e){var i=e.editor;i.on("contentDom",function(){var n,a,s=i.editable(),o=s.isInline()?s:i.document;s.attachListener(o,"mousedown",function(s){var o=s.data.getTarget();if(!o.type)return!1;n=e.getByElement(o),a=0,n&&(n.inline&&o.type==CKEDITOR.NODE_ELEMENT&&o.hasAttribute("data-cke-widget-drag-handler")?(a=1,e.focused!=n&&i.getSelection().removeAllRanges()):t.getNestedEditable(n.wrapper,o)?n=null:(s.data.preventDefault(),CKEDITOR.env.ie||n.focus()))}),s.attachListener(o,"mouseup",function(){a&&n&&n.wrapper&&(a=0,n.focus())}),CKEDITOR.env.ie&&s.attachListener(o,"mouseup",function(){setTimeout(function(){n&&n.wrapper&&s.contains(n.wrapper)&&(n.focus(),n=null)})})}),i.on("doubleclick",function(i){var n=e.getByElement(i.data.element);if(n&&!t.getNestedEditable(n.wrapper,i.data.element))return n.fire("doubleclick",{element:i.data.element})},null,null,1)}function C(e){e.editor.on("key",function(t){var i,n=e.focused,a=e.widgetHoldingFocusedEditable;return n?i=n.fire("key",{keyCode:t.data.keyCode}):a&&(n=t.data.keyCode,t=a.focusedEditable,n==CKEDITOR.CTRL+65?(n=t.getBogus(),a=a.editor.createRange(),a.selectNodeContents(t),n&&a.setEndAt(n,CKEDITOR.POSITION_BEFORE_START),a.select(),i=!1):8==n||46==n?(i=a.editor.getSelection().getRanges(),a=i[0],i=!(1==i.length&&a.collapsed&&a.checkBoundaryOfElement(t,CKEDITOR[8==n?"START":"END"]))):i=void 0),i},null,null,1)}function T(e){function t(t){e.focused&&I(e.focused,"cut"==t.name)}var i=e.editor;i.on("contentDom",function(){var e=i.editable();e.attachListener(e,"copy",t),e.attachListener(e,"cut",t)})}function v(e){var i=e.editor;i.on("selectionCheck",function(){e.fire("checkSelection")}),e.on("checkSelection",e.checkSelection,e),i.on("selectionChange",function(n){var a=(n=t.getNestedEditable(i.editable(),n.data.selection.getStartElement()))&&e.getByElement(n),s=e.widgetHoldingFocusedEditable;s?s===a&&s.focusedEditable.equals(n)||(p(e,s,null),a&&n&&p(e,a,n)):a&&n&&p(e,a,n)}),i.on("dataReady",function(){R(e).commit()}),i.on("blur",function(){var t;(t=e.focused)&&s(e,t),(t=e.widgetHoldingFocusedEditable)&&p(e,t,null)})}function w(e){var i=e.editor,n={};i.on("toDataFormat",function(i){var a=CKEDITOR.tools.getNextNumber(),s=[];i.data.downcastingSessionId=a,n[a]=s,i.data.dataValue.forEach(function(i){var n,a=i.attributes;if("data-cke-widget-id"in a)(a=e.instances[a["data-cke-widget-id"]])&&(n=i.getFirst(t.isParserWidgetElement),s.push({wrapper:i,element:n,widget:a,editables:{}}),
"1"!=n.attributes["data-cke-widget-keep-attr"]&&delete n.attributes["data-widget"]);else if("data-cke-widget-editable"in a)return s[s.length-1].editables[a["data-cke-widget-editable"]]=i,!1},CKEDITOR.NODE_ELEMENT,!0)},null,null,8),i.on("toDataFormat",function(e){if(e.data.downcastingSessionId){e=n[e.data.downcastingSessionId];for(var t,i,a,s,o,r;t=e.shift();){i=t.widget,a=t.element,s=i._.downcastFn&&i._.downcastFn.call(i,a);for(r in t.editables)o=t.editables[r],delete o.attributes.contenteditable,o.setHtml(i.editables[r].getData());s||(s=a),t.wrapper.replaceWith(s)}}},null,null,13),i.on("contentDomUnload",function(){e.destroyAll(!0)})}function b(e){var i,n,a=e.editor;a.on("toHtml",function(n){var a,s=l(e);for(n.data.dataValue.forEach(s.iterator,CKEDITOR.NODE_ELEMENT,!0);a=s.toBeWrapped.pop();){var o=a[0],r=o.parent;r.type==CKEDITOR.NODE_ELEMENT&&r.attributes["data-cke-widget-wrapper"]&&r.replaceWith(o),e.wrapElement(a[0],a[1])}i=n.data.protectedWhitespaces?3==n.data.dataValue.children.length&&t.isParserWidgetWrapper(n.data.dataValue.children[1]):1==n.data.dataValue.children.length&&t.isParserWidgetWrapper(n.data.dataValue.children[0])},null,null,8),a.on("dataReady",function(){if(n)for(var i,s,o=a.editable().find(".cke_widget_wrapper"),r=0,l=o.count();r<l;++r)i=o.getItem(r),s=i.getFirst(t.isDomWidgetElement),s.type==CKEDITOR.NODE_ELEMENT&&s.data("widget")?(s.replace(i),e.wrapElement(s)):i.remove();n=0,e.destroyAll(!0),e.initOnAll()}),a.on("loadSnapshot",function(t){/data-cke-widget/.test(t.data)&&(n=1),e.destroyAll(!0)},null,null,9),a.on("paste",function(e){e=e.data,e.dataValue=e.dataValue.replace(W,f),e.range&&(e=t.getNestedEditable(a.editable(),e.range.startContainer))&&(e=CKEDITOR.filter.instances[e.data("cke-filter")])&&a.setActiveFilter(e)}),a.on("afterInsertHtml",function(t){t.data.intoRange?e.checkWidgets({initOnlyNew:!0}):(a.fire("lockSnapshot"),e.checkWidgets({initOnlyNew:!0,focusInited:i}),a.fire("unlockSnapshot"))})}function R(e){var t=e.selected,i=[],n=t.slice(0),a=null;return{select:function(e){return 0>CKEDITOR.tools.indexOf(t,e)&&i.push(e),e=CKEDITOR.tools.indexOf(n,e),0<=e&&n.splice(e,1),this},focus:function(e){return a=e,this},commit:function(){var o,r,l=e.focused!==a;for(e.editor.fire("lockSnapshot"),l&&(o=e.focused)&&s(e,o);o=n.pop();)t.splice(CKEDITOR.tools.indexOf(t,o),1),o.isInited()&&(r=o.editor.checkDirty(),o.setSelected(!1),!r&&o.editor.resetDirty());for(l&&a&&(r=e.editor.checkDirty(),e.focused=a,e.fire("widgetFocused",{widget:a}),a.setFocused(!0),!r&&e.editor.resetDirty());o=i.pop();)t.push(o),o.setSelected(!0);e.editor.fire("unlockSnapshot")}}}function _(e,t,i){var n=0;t=y(t);var a,s=e.data.classes||{};if(t){for(s=CKEDITOR.tools.clone(s);a=t.pop();)i?s[a]||(n=s[a]=1):s[a]&&(delete s[a],n=1);n&&e.setData("classes",s)}}function D(e){e.cancel()}function I(e,t){var i=e.editor,n=i.document;if(!n.getById("cke_copybin")){var a=i.blockless||CKEDITOR.env.ie?"span":"div",s=n.createElement(a),o=n.createElement(a),a=CKEDITOR.env.ie&&9>CKEDITOR.env.version;o.setAttributes({id:"cke_copybin","data-cke-temp":"1"}),s.setStyles({position:"absolute",width:"1px",height:"1px",overflow:"hidden"}),s.setStyle("ltr"==i.config.contentsLangDirection?"left":"right","-5000px");var r=i.createRange();r.setStartBefore(e.wrapper),r.setEndAfter(e.wrapper),s.setHtml('<span data-cke-copybin-start="1">​</span>'+i.editable().getHtmlFromRange(r).getHtml()+'<span data-cke-copybin-end="1">​</span>'),i.fire("saveSnapshot"),i.fire("lockSnapshot"),o.append(s),i.editable().append(o);var l=i.on("selectionChange",D,null,null,0),d=e.repository.on("checkSelection",D,null,null,0);if(a)var c=n.getDocumentElement().$,u=c.scrollTop;r=i.createRange(),r.selectNodeContents(s),r.select(),a&&(c.scrollTop=u),setTimeout(function(){t||e.focus(),o.remove(),l.removeListener(),d.removeListener(),i.fire("unlockSnapshot"),t&&(e.repository.del(e),i.fire("saveSnapshot"))},100)}}function y(e){return(e=(e=e.getDefinition().attributes)&&e.class)?e.split(/\s+/):null}function k(){var e=CKEDITOR.document.getActive(),t=this.editor,i=t.editable();(i.isInline()?i:t.document.getWindow().getFrame()).equals(e)&&t.focusManager.focus(i)}function O(){CKEDITOR.env.gecko&&this.editor.unlockSelection(),CKEDITOR.env.webkit||(this.editor.forceNextSelectionCheck(),this.editor.selectionChange(1))}function S(e){var t=null;e.on("data",function(){var e,i=this.data.classes;if(t!=i){for(e in t)i&&i[e]||this.removeClass(e);for(e in i)this.addClass(e);t=i}})}function K(e){e.on("data",function(){if(e.wrapper){var t=this.getLabel?this.getLabel():this.editor.lang.widget.label.replace(/%1/,this.pathName||this.element.getName());e.wrapper.setAttribute("role","region"),e.wrapper.setAttribute("aria-label",t)}},null,null,9999)}function A(e){if(e.draggable){var i,n=e.editor,a=e.wrapper.getLast(t.isDomDragHandlerContainer);a?i=a.findOne("img"):(a=new CKEDITOR.dom.element("span",n.document),a.setAttributes({class:"cke_reset cke_widget_drag_handler_container",style:"background:rgba(220,220,220,0.5);background-image:url("+n.plugins.widget.path+"images/handle.png)"}),i=new CKEDITOR.dom.element("img",n.document),i.setAttributes({class:"cke_reset cke_widget_drag_handler","data-cke-widget-drag-handler":"1",src:CKEDITOR.tools.transparentImageData,width:15,title:n.lang.widget.move,height:15,role:"presentation"}),e.inline&&i.setAttribute("draggable","true"),a.append(i),e.wrapper.append(a)),e.wrapper.on("dragover",function(e){e.data.preventDefault()}),e.wrapper.on("mouseenter",e.updateDragHandlerPosition,e),setTimeout(function(){e.on("data",e.updateDragHandlerPosition,e)},50),!e.inline&&(i.on("mousedown",L,e),CKEDITOR.env.ie&&9>CKEDITOR.env.version)&&i.on("dragstart",function(e){e.data.preventDefault(!0)}),e.dragHandlerContainer=a}}function L(e){function t(){var t;for(h.reset();t=d.pop();)t.removeListener();var i=c;t=e.sender;var n=this.repository.finder,a=this.repository.liner,s=this.editor,o=this.editor.editable();CKEDITOR.tools.isEmpty(a.visible)||(i=n.getRange(i[0]),this.focus(),s.fire("drop",{dropRange:i,target:i.startContainer})),o.removeClass("cke_widget_dragging"),a.hideVisible(),s.fire("dragend",{target:t})}var i,n,a=this.repository.finder,s=this.repository.locator,o=this.repository.liner,r=this.editor,l=r.editable(),d=[],c=[];this.repository._.draggedWidget=this;var u=a.greedySearch(),h=CKEDITOR.tools.eventsBuffer(50,function(){i=s.locate(u),c=s.sort(n,1),c.length&&(o.prepare(u,i),o.placeLine(c[0]),o.cleanup())});l.addClass("cke_widget_dragging"),d.push(l.on("mousemove",function(e){n=e.data.$.clientY,h.input()})),r.fire("dragstart",{target:e.sender}),d.push(r.document.once("mouseup",t,this)),l.isInline()||d.push(CKEDITOR.document.once("mouseup",t,this))}function N(e){var t,i,n=e.editables;if(e.editables={},e.editables)for(t in n)i=n[t],e.initEditable(t,"string"==typeof i?{selector:i}:i)}function x(e){if(e.mask){var t=e.wrapper.findOne(".cke_widget_mask");t||(t=new CKEDITOR.dom.element("img",e.editor.document),t.setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_mask"}),e.wrapper.append(t)),e.mask=t}}function F(e){if(e.parts){var t,i,n={};for(i in e.parts)t=e.wrapper.findOne(e.parts[i]),n[i]=t;e.parts=n}}function P(e,i){M(e),F(e),N(e),x(e),A(e),S(e),K(e),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&e.wrapper.on("dragstart",function(i){var n=i.data.getTarget();t.getNestedEditable(e,n)||e.inline&&t.isDomDragHandler(n)||i.data.preventDefault()}),e.wrapper.removeClass("cke_widget_new"),e.element.addClass("cke_widget_element"),e.on("key",function(t){if(13==(t=t.data.keyCode))e.edit();else{if(t==CKEDITOR.CTRL+67||t==CKEDITOR.CTRL+88)return void I(e,t==CKEDITOR.CTRL+88);if(t in B||CKEDITOR.CTRL&t||CKEDITOR.ALT&t)return}return!1},null,null,999),e.on("doubleclick",function(t){e.edit()&&t.cancel()}),i.data&&e.on("data",i.data),i.edit&&e.on("edit",i.edit)}function M(e){(e.wrapper=e.element.getParent()).setAttribute("data-cke-widget-id",e.id)}function U(e){e.element.data("cke-widget-data",encodeURIComponent(JSON.stringify(e.data)))}CKEDITOR.plugins.add("widget",{lang:"af,ar,az,bg,ca,cs,cy,da,de,de-ch,el,en,en-gb,eo,es,eu,fa,fi,fr,gl,he,hr,hu,id,it,ja,km,ko,ku,lv,nb,nl,no,oc,pl,pt,pt-br,ru,sk,sl,sq,sv,tr,tt,ug,uk,vi,zh,zh-cn",requires:"lineutils,clipboard,widgetselection",onLoad:function(){CKEDITOR.addCss(".cke_widget_wrapper{position:relative;outline:none}.cke_widget_inline{display:inline-block}.cke_widget_wrapper:hover>.cke_widget_element{outline:2px solid yellow;cursor:default}.cke_widget_wrapper:hover .cke_widget_editable{outline:2px solid yellow}.cke_widget_wrapper.cke_widget_focused>.cke_widget_element,.cke_widget_wrapper .cke_widget_editable.cke_widget_editable_focused{outline:2px solid #ace}.cke_widget_editable{cursor:text}.cke_widget_drag_handler_container{position:absolute;width:15px;height:0;display:none;opacity:0.75;transition:height 0s 0.2s;line-height:0}.cke_widget_wrapper:hover>.cke_widget_drag_handler_container{height:15px;transition:none}.cke_widget_drag_handler_container:hover{opacity:1}img.cke_widget_drag_handler{cursor:move;width:15px;height:15px;display:inline-block}.cke_widget_mask{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.cke_editable.cke_widget_dragging, .cke_editable.cke_widget_dragging *{cursor:move !important}")},beforeInit:function(t){t.widgets=new e(t)},afterInit:function(e){var t,i,n,a=e.widgets.registered;for(i in a)t=a[i],(n=t.button)&&e.ui.addButton&&e.ui.addButton(CKEDITOR.tools.capitalize(t.name,!0),{label:n,command:t.name,toolbar:"insert,10"});g(e)}}),e.prototype={MIN_SELECTION_CHECK_INTERVAL:500,add:function(e,t){return t=CKEDITOR.tools.prototypedCopy(t),t.name=e,t._=t._||{},this.editor.fire("widgetDefinition",t),t.template&&(t.template=new CKEDITOR.template(t.template)),n(this.editor,t),a(this,t),this.registered[e]=t},addUpcastCallback:function(e){this._.upcastCallbacks.push(e)},checkSelection:function(){var e,i=this.editor.getSelection(),n=i.getSelectedElement(),a=R(this);if(n&&(e=this.getByElement(n,!0)))return a.focus(e).select(e).commit();if(!(i=i.getRanges()[0])||i.collapsed)return a.commit();for(i=new CKEDITOR.dom.walker(i),i.evaluator=t.isDomWidgetWrapper;n=i.next();)a.select(this.getByElement(n));a.commit()},checkWidgets:function(e){this.fire("checkWidgets",CKEDITOR.tools.copy(e||{}))},del:function(e){if(this.focused===e){var t,i=e.editor,n=i.createRange();(t=n.moveToClosestEditablePosition(e.wrapper,!0))||(t=n.moveToClosestEditablePosition(e.wrapper,!1)),t&&i.getSelection().selectRanges([n])}e.wrapper.remove(),this.destroy(e,!0)},destroy:function(e,t){this.widgetHoldingFocusedEditable===e&&p(this,e,null,t),e.destroy(t),delete this.instances[e.id],this.fire("instanceDestroyed",e)},destroyAll:function(e,t){var i,n,a=this.instances;if(t&&!e){n=t.find(".cke_widget_wrapper");for(var a=n.count(),s=0;s<a;++s)(i=this.getByElement(n.getItem(s),!0))&&this.destroy(i)}else for(n in a)i=a[n],this.destroy(i,e)},finalizeCreation:function(e){(e=e.getFirst())&&t.isDomWidgetWrapper(e)&&(this.editor.insertElement(e),e=this.getByElement(e),e.ready=!0,e.fire("ready"),e.focus())},getByElement:function(){function e(e){return e.is(t)&&e.data("cke-widget-id")}var t={div:1,span:1};return function(t,i){if(!t)return null;var n=e(t);if(!i&&!n){var a=this.editor.editable();do{t=t.getParent()}while(t&&!t.equals(a)&&!(n=e(t)))}return this.instances[n]||null}}(),initOn:function(e,i,n){if(i?"string"==typeof i&&(i=this.registered[i]):i=this.registered[e.data("widget")],!i)return null;var a=this.wrapElement(e,i.name);return a?a.hasClass("cke_widget_new")?(e=new t(this,this._.nextId++,e,i,n),e.isInited()?this.instances[e.id]=e:null):this.getByElement(e):null},initOnAll:function(e){e=(e||this.editor.editable()).find(".cke_widget_new");for(var i,n=[],a=e.count();a--;)(i=this.initOn(e.getItem(a).getFirst(t.isDomWidgetElement)))&&n.push(i);return n},onWidget:function(e){var t=Array.prototype.slice.call(arguments);t.shift();for(var i in this.instances){var n=this.instances[i];n.name==e&&n.on.apply(n,t)}this.on("instanceCreated",function(i){i=i.data,i.name==e&&i.on.apply(i,t)})},parseElementClasses:function(e){if(!e)return null;e=CKEDITOR.tools.trim(e).split(/\s+/);for(var t,i={},n=0;t=e.pop();)-1==t.indexOf("cke_")&&(i[t]=n=1);return n?i:null},wrapElement:function(e,t){var i,n,a=null;if(e instanceof CKEDITOR.dom.element){if(t=t||e.data("widget"),!(i=this.registered[t]))return null;if((a=e.getParent())&&a.type==CKEDITOR.NODE_ELEMENT&&a.data("cke-widget-wrapper"))return a;e.hasAttribute("data-cke-widget-keep-attr")||e.data("cke-widget-keep-attr",e.data("widget")?1:0),e.data("widget",t),n=u(i,e.getName()),a=new CKEDITOR.dom.element(n?"span":"div"),a.setAttributes(d(n,t)),a.data("cke-display-name",i.pathName?i.pathName:e.getName()),e.getParent(!0)&&a.replace(e),e.appendTo(a)}else if(e instanceof CKEDITOR.htmlParser.element){if(t=t||e.attributes["data-widget"],!(i=this.registered[t]))return null;if((a=e.parent)&&a.type==CKEDITOR.NODE_ELEMENT&&a.attributes["data-cke-widget-wrapper"])return a;"data-cke-widget-keep-attr"in e.attributes||(e.attributes["data-cke-widget-keep-attr"]=e.attributes["data-widget"]?1:0),t&&(e.attributes["data-widget"]=t),n=u(i,e.name),a=new CKEDITOR.htmlParser.element(n?"span":"div",d(n,t)),a.attributes["data-cke-display-name"]=i.pathName?i.pathName:e.name,i=e.parent;var s;i&&(s=e.getIndex(),e.remove()),a.add(e),i&&c(i,s,a)}return a},_tests_createEditableFilter:r},CKEDITOR.event.implementOn(e.prototype),t.prototype={addClass:function(e){this.element.addClass(e),this.wrapper.addClass(t.WRAPPER_CLASS_PREFIX+e)},applyStyle:function(e){_(this,e,1)},checkStyleActive:function(e){e=y(e);var t;if(!e)return!1;for(;t=e.pop();)if(!this.hasClass(t))return!1;return!0},destroy:function(e){if(this.fire("destroy"),this.editables)for(var t in this.editables)this.destroyEditable(t,e);e||("0"==this.element.data("cke-widget-keep-attr")&&this.element.removeAttribute("data-widget"),this.element.removeAttributes(["data-cke-widget-data","data-cke-widget-keep-attr"]),this.element.removeClass("cke_widget_element"),this.element.replace(this.wrapper)),this.wrapper=null},destroyEditable:function(e,t){var i=this.editables[e];i.removeListener("focus",O),i.removeListener("blur",k),this.editor.focusManager.remove(i),t||(this.repository.destroyAll(!1,i),i.removeClass("cke_widget_editable"),i.removeClass("cke_widget_editable_focused"),i.removeAttributes(["contenteditable","data-cke-widget-editable","data-cke-enter-mode"])),delete this.editables[e]},edit:function(){var e={dialog:this.dialog},t=this;return!(!1===this.fire("edit",e)||!e.dialog)&&(this.editor.openDialog(e.dialog,function(e){var i,n;!1!==t.fire("dialog",e)&&(i=e.on("show",function(){e.setupContent(t)}),n=e.on("ok",function(){var i,n=t.on("data",function(e){i=1,e.cancel()},null,null,0);t.editor.fire("saveSnapshot"),e.commitContent(t),n.removeListener(),i&&(t.fire("data",t.data),t.editor.fire("saveSnapshot"))}),e.once("hide",function(){i.removeListener(),n.removeListener()}))}),!0)},getClasses:function(){return this.repository.parseElementClasses(this.element.getAttribute("class"))},hasClass:function(e){return this.element.hasClass(e)},initEditable:function(e,t){var n=this._findOneNotNested(t.selector);return!(!n||!n.is(CKEDITOR.dtd.$editable))&&(n=new i(this.editor,n,{filter:r.call(this.repository,this.name,e,t)}),this.editables[e]=n,n.setAttributes({contenteditable:"true","data-cke-widget-editable":e,"data-cke-enter-mode":n.enterMode}),n.filter&&n.data("cke-filter",n.filter.id),n.addClass("cke_widget_editable"),n.removeClass("cke_widget_editable_focused"),t.pathName&&n.data("cke-display-name",t.pathName),this.editor.focusManager.add(n),n.on("focus",O,this),CKEDITOR.env.ie&&n.on("blur",k,this),n._.initialSetData=!0,n.setData(n.getHtml()),!0)},_findOneNotNested:function(e){e=this.wrapper.find(e);for(var i,n,a=0;a<e.count();a++)if(i=e.getItem(a),n=i.getAscendant(t.isDomWidgetWrapper),this.wrapper.equals(n))return i;return null},isInited:function(){return!(!this.wrapper||!this.inited)},isReady:function(){return this.isInited()&&this.ready},focus:function(){var e=this.editor.getSelection();if(e){var t=this.editor.checkDirty();e.fake(this.wrapper),!t&&this.editor.resetDirty()}this.editor.focus()},removeClass:function(e){this.element.removeClass(e),this.wrapper.removeClass(t.WRAPPER_CLASS_PREFIX+e)},removeStyle:function(e){_(this,e,0)},setData:function(e,t){var i=this.data,n=0;if("string"==typeof e)i[e]!==t&&(i[e]=t,n=1);else{var a=e;for(e in a)i[e]!==a[e]&&(n=1,i[e]=a[e])}return n&&this.dataReady&&(U(this),this.fire("data",i)),this},setFocused:function(e){return this.wrapper[e?"addClass":"removeClass"]("cke_widget_focused"),this.fire(e?"focus":"blur"),this},setSelected:function(e){return this.wrapper[e?"addClass":"removeClass"]("cke_widget_selected"),this.fire(e?"select":"deselect"),this},updateDragHandlerPosition:function(){var e=this.editor,t=this.element.$,i=this._.dragHandlerOffset,t={x:t.offsetLeft,y:t.offsetTop-15};i&&t.x==i.x&&t.y==i.y||(i=e.checkDirty(),e.fire("lockSnapshot"),this.dragHandlerContainer.setStyles({top:t.y+"px",left:t.x+"px",display:"block"}),e.fire("unlockSnapshot"),!i&&e.resetDirty(),this._.dragHandlerOffset=t)}},CKEDITOR.event.implementOn(t.prototype),t.getNestedEditable=function(e,i){return!i||i.equals(e)?null:t.isDomNestedEditable(i)?i:t.getNestedEditable(e,i.getParent())},t.isDomDragHandler=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-drag-handler")},t.isDomDragHandlerContainer=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_widget_drag_handler_container")},t.isDomNestedEditable=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-editable")},t.isDomWidgetElement=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-widget")},t.isDomWidgetWrapper=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-wrapper")},t.isParserWidgetElement=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&!!e.attributes["data-widget"]},t.isParserWidgetWrapper=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&!!e.attributes["data-cke-widget-wrapper"]},t.WRAPPER_CLASS_PREFIX="cke_widget_wrapper_",i.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.dom.element.prototype),{setData:function(e){this._.initialSetData||this.editor.widgets.destroyAll(!1,this),this._.initialSetData=!1,e=this.editor.dataProcessor.toHtml(e,{context:this.getName(),filter:this.filter,enterMode:this.enterMode}),this.setHtml(e),this.editor.widgets.initOnAll(this)},getData:function(){return this.editor.dataProcessor.toDataFormat(this.getHtml(),{context:this.getName(),filter:this.filter,enterMode:this.enterMode})}});var W=/^(?:<(?:div|span)(?: data-cke-temp="1")?(?: id="cke_copybin")?(?: data-cke-temp="1")?>)?(?:<(?:div|span)(?: style="[^"]+")?>)?<span [^>]*data-cke-copybin-start="1"[^>]*>.?<\/span>([\s\S]+)<span [^>]*data-cke-copybin-end="1"[^>]*>.?<\/span>(?:<\/(?:div|span)>)?(?:<\/(?:div|span)>)?$/i,B={37:1,38:1,39:1,40:1,8:1,46:1};!function(){function e(){}function i(e,t,i){return!(!i||!this.checkElement(e))&&((e=i.widgets.getByElement(e,!0))&&e.checkStyleActive(this))}var n={};CKEDITOR.style.addCustomHandler({type:"widget",setup:function(e){if(this.widget=e.widget,this.group="string"==typeof e.group?[e.group]:e.group){e=this.widget;var t;n[e]||(n[e]={});for(var i=0,a=this.group.length;i<a;i++)t=this.group[i],n[e][t]||(n[e][t]=[]),n[e][t].push(this)}},apply:function(e){var t;e instanceof CKEDITOR.editor&&this.checkApplicable(e.elementPath(),e)&&(t=e.widgets.focused,this.group&&this.removeStylesFromSameGroup(e),t.applyStyle(this))},remove:function(e){e instanceof CKEDITOR.editor&&this.checkApplicable(e.elementPath(),e)&&e.widgets.focused.removeStyle(this)},removeStylesFromSameGroup:function(e){var t,i,a=!1;if(!(e instanceof CKEDITOR.editor))return!1;if(i=e.elementPath(),this.checkApplicable(i,e))for(var s=0,o=this.group.length;s<o;s++){t=n[this.widget][this.group[s]];for(var r=0;r<t.length;r++)t[r]!==this&&t[r].checkActive(i,e)&&(e.widgets.focused.removeStyle(t[r]),a=!0)}return a},checkActive:function(e,t){return this.checkElementMatch(e.lastElement,0,t)},checkApplicable:function(e,t){return t instanceof CKEDITOR.editor&&this.checkElement(e.lastElement)},checkElementMatch:i,checkElementRemovable:i,checkElement:function(e){return!!t.isDomWidgetWrapper(e)&&((e=e.getFirst(t.isDomWidgetElement))&&e.data("widget")==this.widget)},buildPreview:function(e){return e||this._.definition.name},toAllowedContentRules:function(e){if(!e)return null;e=e.widgets.registered[this.widget];var t,i={};return e?e.styleableElements?(t=this.getClassesArray())?(i[e.styleableElements]={classes:t,propertiesOnly:!0},i):null:e.styleToAllowedContentRules?e.styleToAllowedContentRules(this):null:null},getClassesArray:function(){var e=this._.definition.attributes&&this._.definition.attributes.class;return e?CKEDITOR.tools.trim(e).split(/\s+/):null},applyToRange:e,removeFromRange:e,applyToObject:e})}(),CKEDITOR.plugins.widget=t,t.repository=e,t.nestedEditable=i}(),function(){CKEDITOR.plugins.add("uploadwidget",{lang:"az,ca,cs,da,de,de-ch,el,en,eo,es,eu,fr,gl,hu,id,it,ja,km,ko,ku,nb,nl,no,oc,pl,pt,pt-br,ru,sv,tr,ug,uk,zh,zh-cn",requires:"widget,clipboard,filetools,notificationaggregator",init:function(e){e.filter.allow("*[!data-widget,!data-cke-upload-id]")}}),CKEDITOR.fileTools||(CKEDITOR.fileTools={}),CKEDITOR.tools.extend(CKEDITOR.fileTools,{addUploadWidget:function(e,t,i){var n=CKEDITOR.fileTools,a=e.uploadRepository,s=i.supportedTypes?10:20;i.fileToElement&&e.on("paste",function(s){s=s.data;var o,r,l=s.dataTransfer,d=l.getFilesCount(),c=i.loadMethod||"loadAndUpload";if(!s.dataValue&&d)for(r=0;r<d;r++)if(o=l.getFile(r),!i.supportedTypes||n.isTypeSupported(o,i.supportedTypes)){var u=i.fileToElement(o);o=a.create(o),u&&(o[c](i.uploadUrl,i.additionalRequestParameters),CKEDITOR.fileTools.markElement(u,t,o.id),"loadAndUpload"!=c&&"upload"!=c||CKEDITOR.fileTools.bindNotifications(e,o),s.dataValue+=u.getOuterHtml())}},null,null,s),CKEDITOR.tools.extend(i,{downcast:function(){return new CKEDITOR.htmlParser.text("")},init:function(){var t,i,n=this,s=this.wrapper.findOne("[data-cke-upload-id]").data("cke-upload-id"),o=a.loaders[s],r=CKEDITOR.tools.capitalize;o.on("update",function(a){n.wrapper&&n.wrapper.getParent()?(e.fire("lockSnapshot"),a="on"+r(o.status),"function"==typeof n[a]&&!1===n[a](o)||(i="cke_upload_"+o.status,n.wrapper&&i!=t&&(t&&n.wrapper.removeClass(t),n.wrapper.addClass(i),t=i),"error"!=o.status&&"abort"!=o.status||e.widgets.del(n)),e.fire("unlockSnapshot")):(e.editable().find('[data-cke-upload-id="'+s+'"]').count()||o.abort(),a.removeListener())}),o.update()},replaceWith:function(t,i){if(""===t.trim())e.widgets.del(this);else{var n,a,s=this==e.widgets.focused,o=e.editable(),r=e.createRange();s||(a=e.getSelection().createBookmarks()),r.setStartBefore(this.wrapper),r.setEndAfter(this.wrapper),s&&(n=r.createBookmark()),o.insertHtmlIntoRange(t,r,i),e.widgets.checkWidgets({initOnlyNew:!0}),e.widgets.destroy(this,!0),s?(r.moveToBookmark(n),r.select()):e.getSelection().selectBookmarks(a)}}}),e.widgets.add(t,i)},markElement:function(e,t,i){e.setAttributes({"data-cke-upload-id":i,"data-widget":t})},bindNotifications:function(e,t){function i(){(n=e._.uploadWidgetNotificaionAggregator)&&!n.isFinished()||(n=e._.uploadWidgetNotificaionAggregator=new CKEDITOR.plugins.notificationAggregator(e,e.lang.uploadwidget.uploadMany,e.lang.uploadwidget.uploadOne),n.once("finished",function(){var t=n.getTaskCount();0===t?n.notification.hide():n.notification.update({message:1==t?e.lang.uploadwidget.doneOne:e.lang.uploadwidget.doneMany.replace("%1",t),type:"success",important:1})}))}var n,a=null;t.on("update",function(){!a&&t.uploadTotal&&(i(),a=n.createTask({weight:t.uploadTotal})),a&&"uploading"==t.status&&a.update(t.uploaded)}),t.on("uploaded",function(){a&&a.done()}),t.on("error",function(){a&&a.cancel(),e.showNotification(t.message,"warning")}),t.on("abort",function(){a&&a.cancel(),e.showNotification(e.lang.uploadwidget.abort,"info")})}})}(),function(){function e(e){this.editor=e,this.loaders=[]}function t(e,t,n){var a=e.config.fileTools_defaultFileName;this.editor=e,this.lang=e.lang,"string"==typeof t?(this.data=t,this.file=i(this.data),this.loaded=this.total=this.file.size):(this.data=null,this.file=t,this.total=this.file.size,this.loaded=0),n?this.fileName=n:this.file.name?this.fileName=this.file.name:(e=this.file.type.split("/"),a&&(e[0]=a),this.fileName=e.join(".")),this.uploaded=0,this.responseData=this.uploadTotal=null,this.status="created",this.abort=function(){this.changeStatus("abort")}}function i(e){var t=e.match(n)[1];e=e.replace(n,""),e=atob(e);var i,a,s,o,r=[];for(i=0;i<e.length;i+=512){for(a=e.slice(i,i+512),s=Array(a.length),o=0;o<a.length;o++)s[o]=a.charCodeAt(o);a=new Uint8Array(s),r.push(a)}return new Blob(r,{type:t})}CKEDITOR.plugins.add("filetools",{lang:"az,ca,cs,da,de,de-ch,en,eo,es,eu,fr,gl,id,it,ja,km,ko,ku,nb,nl,oc,pl,pt,pt-br,ru,sv,tr,ug,uk,zh,zh-cn",beforeInit:function(t){t.uploadRepository=new e(t),t.on("fileUploadRequest",function(e){var t=e.data.fileLoader;t.xhr.open("POST",t.uploadUrl,!0),e.data.requestData.upload={file:t.file,name:t.fileName}},null,null,5),t.on("fileUploadRequest",function(e){var t=e.data.fileLoader,i=new FormData;e=e.data.requestData;for(var n in e){var a=e[n];"object"==typeof a&&a.file?i.append(n,a.file,a.name):i.append(n,a)}i.append("ckCsrfToken",CKEDITOR.tools.getCsrfToken()),t.xhr.send(i)},null,null,999),t.on("fileUploadResponse",function(e){var t=e.data.fileLoader,i=t.xhr,n=e.data;try{var a=JSON.parse(i.responseText);if(a.error&&a.error.message&&(n.message=a.error.message),a.uploaded)for(var s in a)n[s]=a[s];else e.cancel()}catch(a){n.message=t.lang.filetools.responseError,CKEDITOR.warn("filetools-response-error",{responseText:i.responseText}),e.cancel()}},null,null,999)}}),e.prototype={create:function(e,i){var n=this.loaders.length,a=new t(this.editor,e,i);return a.id=n,this.loaders[n]=a,this.fire("instanceCreated",a),a},isFinished:function(){for(var e=0;e<this.loaders.length;++e)if(!this.loaders[e].isFinished())return!1;return!0}},t.prototype={loadAndUpload:function(e,t){var i=this;this.once("loaded",function(n){n.cancel(),i.once("update",function(e){e.cancel()},null,null,0),i.upload(e,t)},null,null,0),this.load()},load:function(){var e=this,t=this.reader=new FileReader;e.changeStatus("loading"),this.abort=function(){e.reader.abort()},t.onabort=function(){e.changeStatus("abort")},t.onerror=function(){e.message=e.lang.filetools.loadError,e.changeStatus("error")},t.onprogress=function(t){e.loaded=t.loaded,e.update()},t.onload=function(){e.loaded=e.total,e.data=t.result,e.changeStatus("loaded")},t.readAsDataURL(this.file)},upload:function(e,t){var i=t||{};e?(this.uploadUrl=e,this.xhr=new XMLHttpRequest,this.attachRequestListeners(),this.editor.fire("fileUploadRequest",{fileLoader:this,requestData:i})&&this.changeStatus("uploading")):(this.message=this.lang.filetools.noUrlError,this.changeStatus("error"))},attachRequestListeners:function(){function e(){"error"!=i.status&&(i.message=i.lang.filetools.networkError,i.changeStatus("error"))}function t(){"abort"!=i.status&&i.changeStatus("abort")}var i=this,n=this.xhr;i.abort=function(){n.abort(),t()},n.onerror=e,n.onabort=t,n.upload?(n.upload.onprogress=function(e){e.lengthComputable&&(i.uploadTotal||(i.uploadTotal=e.total),i.uploaded=e.loaded,i.update())},n.upload.onerror=e,n.upload.onabort=t):(i.uploadTotal=i.total,i.update()),n.onload=function(){if(i.update(),"abort"!=i.status)if(i.uploaded=i.uploadTotal,200>n.status||299<n.status)i.message=i.lang.filetools["httpError"+n.status],i.message||(i.message=i.lang.filetools.httpError.replace("%1",n.status)),i.changeStatus("error");else{for(var e={fileLoader:i},t=["message","fileName","url"],a=i.editor.fire("fileUploadResponse",e),s=0;s<t.length;s++){var o=t[s];"string"==typeof e[o]&&(i[o]=e[o])}i.responseData=e,delete i.responseData.fileLoader,!1===a?i.changeStatus("error"):i.changeStatus("uploaded")}}},changeStatus:function(e){this.status=e,"error"!=e&&"abort"!=e&&"loaded"!=e&&"uploaded"!=e||(this.abort=function(){}),this.fire(e),this.update()},update:function(){this.fire("update")},isFinished:function(){return!!this.status.match(/^(?:loaded|uploaded|error|abort)$/)}},CKEDITOR.event.implementOn(e.prototype),CKEDITOR.event.implementOn(t.prototype);var n=/^data:(\S*?);base64,/;CKEDITOR.fileTools||(CKEDITOR.fileTools={}),CKEDITOR.tools.extend(CKEDITOR.fileTools,{uploadRepository:e,fileLoader:t,getUploadUrl:function(e,t){var i=CKEDITOR.tools.capitalize;return t&&e[t+"UploadUrl"]?e[t+"UploadUrl"]:e.uploadUrl?e.uploadUrl:t&&e["filebrowser"+i(t,1)+"UploadUrl"]?e["filebrowser"+i(t,1)+"UploadUrl"]+"&responseType=json":e.filebrowserUploadUrl?e.filebrowserUploadUrl+"&responseType=json":null},isTypeSupported:function(e,t){return!!e.type.match(t)}})}(),function(){function e(e,t,i){this.editor=e,this.notification=null,this._message=new CKEDITOR.template(t),this._singularMessage=i?new CKEDITOR.template(i):null,this._tasks=[],this._doneTasks=this._doneWeights=this._totalWeights=0}function t(e){this._weight=e||1,this._doneWeight=0,this._isCanceled=!1}CKEDITOR.plugins.add("notificationaggregator",{requires:"notification"}),e.prototype={createTask:function(e){e=e||{};var t,i=!this.notification;return i&&(this.notification=this._createNotification()),t=this._addTask(e),t.on("updated",this._onTaskUpdate,this),t.on("done",this._onTaskDone,this),t.on("canceled",function(){this._removeTask(t)},this),this.update(),i&&this.notification.show(),t},update:function(){this._updateNotification(),this.isFinished()&&this.fire("finished")},getPercentage:function(){return 0===this.getTaskCount()?1:this._doneWeights/this._totalWeights},isFinished:function(){return this.getDoneTaskCount()===this.getTaskCount()},getTaskCount:function(){return this._tasks.length},getDoneTaskCount:function(){return this._doneTasks},_updateNotification:function(){this.notification.update({message:this._getNotificationMessage(),progress:this.getPercentage()})},_getNotificationMessage:function(){var e=this.getTaskCount(),t={current:this.getDoneTaskCount(),max:e,percentage:Math.round(100*this.getPercentage())};return(1==e&&this._singularMessage?this._singularMessage:this._message).output(t)},_createNotification:function(){return new CKEDITOR.plugins.notification(this.editor,{type:"progress"})},_addTask:function(e){return e=new t(e.weight),this._tasks.push(e),this._totalWeights+=e._weight,e},_removeTask:function(e){var t=CKEDITOR.tools.indexOf(this._tasks,e);-1!==t&&(e._doneWeight&&(this._doneWeights-=e._doneWeight),this._totalWeights-=e._weight,this._tasks.splice(t,1),this.update())},_onTaskUpdate:function(e){this._doneWeights+=e.data,this.update()},_onTaskDone:function(){this._doneTasks+=1,this.update()}},CKEDITOR.event.implementOn(e.prototype),t.prototype={done:function(){this.update(this._weight)},update:function(e){if(!this.isDone()&&!this.isCanceled()){e=Math.min(this._weight,e);var t=e-this._doneWeight;this._doneWeight=e,this.fire("updated",t),this.isDone()&&this.fire("done")}},cancel:function(){this.isDone()||this.isCanceled()||(this._isCanceled=!0,this.fire("canceled"))},isDone:function(){return this._weight===this._doneWeight},isCanceled:function(){return this._isCanceled}},CKEDITOR.event.implementOn(t.prototype),CKEDITOR.plugins.notificationAggregator=e,CKEDITOR.plugins.notificationAggregator.task=t}(),function(){function e(e,t){CKEDITOR.tools.extend(this,{editor:e,editable:e.editable(),doc:e.document,win:e.window},t,!0),this.inline=this.editable.isInline(),this.inline||(this.frame=this.win.getFrame()),this.target=this[this.inline?"editable":"doc"]}function t(e,t){CKEDITOR.tools.extend(this,t,{editor:e},!0)}function i(e,t){var i=e.editable();CKEDITOR.tools.extend(this,{editor:e,editable:i,inline:i.isInline(),doc:e.document,win:e.window,container:CKEDITOR.document.getBody(),
winTop:CKEDITOR.document.getWindow()},t,!0),this.hidden={},this.visible={},this.inline||(this.frame=this.win.getFrame()),this.queryViewport();var n=CKEDITOR.tools.bind(this.queryViewport,this),o=CKEDITOR.tools.bind(this.hideVisible,this),r=CKEDITOR.tools.bind(this.removeAll,this);i.attachListener(this.winTop,"resize",n),i.attachListener(this.winTop,"scroll",n),i.attachListener(this.winTop,"resize",o),i.attachListener(this.win,"scroll",o),i.attachListener(this.inline?i:this.frame,"mouseout",function(e){var t=e.data.$.clientX;e=e.data.$.clientY,this.queryViewport(),(t<=this.rect.left||t>=this.rect.right||e<=this.rect.top||e>=this.rect.bottom)&&this.hideVisible(),(0>=t||t>=this.winTopPane.width||0>=e||e>=this.winTopPane.height)&&this.hideVisible()},this),i.attachListener(e,"resize",n),i.attachListener(e,"mode",r),e.on("destroy",r),this.lineTpl=new CKEDITOR.template('<div data-cke-lineutils-line="1" class="cke_reset_all" style="{lineStyle}"><span style="{tipLeftStyle}">&nbsp;</span><span style="{tipRightStyle}">&nbsp;</span></div>').output({lineStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},s,this.lineStyle,!0)),tipLeftStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},a,{left:"0px","border-left-color":"red","border-width":"6px 0 6px 6px"},this.tipCss,this.tipLeftStyle,!0)),tipRightStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},a,{right:"0px","border-right-color":"red","border-width":"6px 6px 6px 0"},this.tipCss,this.tipRightStyle,!0))})}function n(e){var t;return(t=e&&e.type==CKEDITOR.NODE_ELEMENT)&&(t=!(o[e.getComputedStyle("float")]||o[e.getAttribute("align")])),t&&!r[e.getComputedStyle("position")]}CKEDITOR.plugins.add("lineutils"),CKEDITOR.LINEUTILS_BEFORE=1,CKEDITOR.LINEUTILS_AFTER=2,CKEDITOR.LINEUTILS_INSIDE=4,e.prototype={start:function(e){var t,i,n,a,s=this,o=this.editor,r=this.doc,l=CKEDITOR.tools.eventsBuffer(50,function(){o.readOnly||"wysiwyg"!=o.mode||(s.relations={},(i=r.$.elementFromPoint(n,a))&&i.nodeType&&(t=new CKEDITOR.dom.element(i),s.traverseSearch(t),isNaN(n+a)||s.pixelSearch(t,n,a),e&&e(s.relations,n,a)))});this.listener=this.editable.attachListener(this.target,"mousemove",function(e){n=e.data.$.clientX,a=e.data.$.clientY,l.input()}),this.editable.attachListener(this.inline?this.editable:this.frame,"mouseout",function(){l.reset()})},stop:function(){this.listener&&this.listener.removeListener()},getRange:function(){var e={};return e[CKEDITOR.LINEUTILS_BEFORE]=CKEDITOR.POSITION_BEFORE_START,e[CKEDITOR.LINEUTILS_AFTER]=CKEDITOR.POSITION_AFTER_END,e[CKEDITOR.LINEUTILS_INSIDE]=CKEDITOR.POSITION_AFTER_START,function(t){var i=this.editor.createRange();return i.moveToPosition(this.relations[t.uid].element,e[t.type]),i}}(),store:function(){function e(e,t,i){var n=e.getUniqueId();n in i?i[n].type|=t:i[n]={element:e,type:t}}return function(t,i){var a;i&CKEDITOR.LINEUTILS_AFTER&&n(a=t.getNext())&&a.isVisible()&&(e(a,CKEDITOR.LINEUTILS_BEFORE,this.relations),i^=CKEDITOR.LINEUTILS_AFTER),i&CKEDITOR.LINEUTILS_INSIDE&&n(a=t.getFirst())&&a.isVisible()&&(e(a,CKEDITOR.LINEUTILS_BEFORE,this.relations),i^=CKEDITOR.LINEUTILS_INSIDE),e(t,i,this.relations)}}(),traverseSearch:function(e){var t,i,a;do{if(!((a=e.$["data-cke-expando"])&&a in this.relations)){if(e.equals(this.editable))break;if(n(e))for(t in this.lookups)(i=this.lookups[t](e))&&this.store(e,i)}}while((!e||e.type!=CKEDITOR.NODE_ELEMENT||"true"!=e.getAttribute("contenteditable"))&&(e=e.getParent()))},pixelSearch:function(){function e(e,i,a,s,o){for(var r,l=0;o(a)&&(a+=s,25!=++l);)if(r=this.doc.$.elementFromPoint(i,a))if(r==e)l=0;else if(t(e,r)&&(l=0,n(r=new CKEDITOR.dom.element(r))))return r}var t=CKEDITOR.env.ie||CKEDITOR.env.webkit?function(e,t){return e.contains(t)}:function(e,t){return!!(16&e.compareDocumentPosition(t))};return function(t,i,a){var s=this.win.getViewPaneSize().height,o=e.call(this,t.$,i,a,-1,function(e){return 0<e});if(i=e.call(this,t.$,i,a,1,function(e){return e<s}),o)for(this.traverseSearch(o);!o.getParent().equals(t);)o=o.getParent();if(i)for(this.traverseSearch(i);!i.getParent().equals(t);)i=i.getParent();for(;(o||i)&&(o&&(o=o.getNext(n)),o&&!o.equals(i))&&(this.traverseSearch(o),i&&(i=i.getPrevious(n)),i&&!i.equals(o));)this.traverseSearch(i)}}(),greedySearch:function(){this.relations={};for(var e,t,i,a=this.editable.getElementsByTag("*"),s=0;e=a.getItem(s++);)if(!e.equals(this.editable)&&e.type==CKEDITOR.NODE_ELEMENT&&(e.hasAttribute("contenteditable")||!e.isReadOnly())&&n(e)&&e.isVisible())for(i in this.lookups)(t=this.lookups[i](e))&&this.store(e,t);return this.relations}},t.prototype={locate:function(){function e(e,t){var i=e.element[t===CKEDITOR.LINEUTILS_BEFORE?"getPrevious":"getNext"]();return i&&n(i)?(e.siblingRect=i.getClientRect(),t==CKEDITOR.LINEUTILS_BEFORE?(e.siblingRect.bottom+e.elementRect.top)/2:(e.elementRect.bottom+e.siblingRect.top)/2):t==CKEDITOR.LINEUTILS_BEFORE?e.elementRect.top:e.elementRect.bottom}return function(t){var i;this.locations={};for(var n in t)i=t[n],i.elementRect=i.element.getClientRect(),i.type&CKEDITOR.LINEUTILS_BEFORE&&this.store(n,CKEDITOR.LINEUTILS_BEFORE,e(i,CKEDITOR.LINEUTILS_BEFORE)),i.type&CKEDITOR.LINEUTILS_AFTER&&this.store(n,CKEDITOR.LINEUTILS_AFTER,e(i,CKEDITOR.LINEUTILS_AFTER)),i.type&CKEDITOR.LINEUTILS_INSIDE&&this.store(n,CKEDITOR.LINEUTILS_INSIDE,(i.elementRect.top+i.elementRect.bottom)/2);return this.locations}}(),sort:function(){var e,t,i,n;return function(a,s){e=this.locations,t=[];for(var o in e)for(var r in e[o])if(i=Math.abs(a-e[o][r]),t.length){for(n=0;n<t.length;n++)if(i<t[n].dist){t.splice(n,0,{uid:+o,type:r,dist:i});break}n==t.length&&t.push({uid:+o,type:r,dist:i})}else t.push({uid:+o,type:r,dist:i});return void 0!==s?t.slice(0,s):t}}(),store:function(e,t,i){this.locations[e]||(this.locations[e]={}),this.locations[e][t]=i}};var a={display:"block",width:"0px",height:"0px","border-color":"transparent","border-style":"solid",position:"absolute",top:"-6px"},s={height:"0px","border-top":"1px dashed red",position:"absolute","z-index":9999};i.prototype={removeAll:function(){for(var e in this.hidden)this.hidden[e].remove(),delete this.hidden[e];for(e in this.visible)this.visible[e].remove(),delete this.visible[e]},hideLine:function(e){var t=e.getUniqueId();e.hide(),this.hidden[t]=e,delete this.visible[t]},showLine:function(e){var t=e.getUniqueId();e.show(),this.visible[t]=e,delete this.hidden[t]},hideVisible:function(){for(var e in this.visible)this.hideLine(this.visible[e])},placeLine:function(e,t){var i,n,a;if(i=this.getStyle(e.uid,e.type)){for(a in this.visible)if(this.visible[a].getCustomData("hash")!==this.hash){n=this.visible[a];break}if(!n)for(a in this.hidden)if(this.hidden[a].getCustomData("hash")!==this.hash){this.showLine(n=this.hidden[a]);break}n||this.showLine(n=this.addLine()),n.setCustomData("hash",this.hash),this.visible[n.getUniqueId()]=n,n.setStyles(i),t&&t(n)}},getStyle:function(e,t){var i=this.relations[e],n=this.locations[e][t],a={};if(a.width=i.siblingRect?Math.max(i.siblingRect.width,i.elementRect.width):i.elementRect.width,a.top=this.inline?n+this.winTopScroll.y-this.rect.relativeY:this.rect.top+this.winTopScroll.y+n,a.top-this.winTopScroll.y<this.rect.top||a.top-this.winTopScroll.y>this.rect.bottom)return!1;this.inline?a.left=i.elementRect.left-this.rect.relativeX:(0<i.elementRect.left?a.left=this.rect.left+i.elementRect.left:(a.width+=i.elementRect.left,a.left=this.rect.left),0<(i=a.left+a.width-(this.rect.left+this.winPane.width))&&(a.width-=i)),a.left+=this.winTopScroll.x;for(var s in a)a[s]=CKEDITOR.tools.cssLength(a[s]);return a},addLine:function(){var e=CKEDITOR.dom.element.createFromHtml(this.lineTpl);return e.appendTo(this.container),e},prepare:function(e,t){this.relations=e,this.locations=t,this.hash=Math.random()},cleanup:function(){var e,t;for(t in this.visible)e=this.visible[t],e.getCustomData("hash")!==this.hash&&this.hideLine(e)},queryViewport:function(){this.winPane=this.win.getViewPaneSize(),this.winTopScroll=this.winTop.getScrollPosition(),this.winTopPane=this.winTop.getViewPaneSize(),this.rect=this.getClientRect(this.inline?this.editable:this.frame)},getClientRect:function(e){e=e.getClientRect();var t=this.container.getDocumentPosition(),i=this.container.getComputedStyle("position");return e.relativeX=e.relativeY=0,"static"!=i&&(e.relativeY=t.y,e.relativeX=t.x,e.top-=e.relativeY,e.bottom-=e.relativeY,e.left-=e.relativeX,e.right-=e.relativeX),e}};var o={left:1,right:1,center:1},r={absolute:1,fixed:1};CKEDITOR.plugins.lineutils={finder:e,locator:t,liner:i}}(),function(){function e(e){return e.getName&&!e.hasAttribute("data-cke-temp")}CKEDITOR.plugins.add("widgetselection",{init:function(e){if(CKEDITOR.env.webkit){var t=CKEDITOR.plugins.widgetselection;e.on("contentDom",function(e){e=e.editor;var i=e.document,n=e.editable();n.attachListener(i,"keydown",function(e){var i=e.data.$;65==e.data.getKey()&&(CKEDITOR.env.mac&&i.metaKey||!CKEDITOR.env.mac&&i.ctrlKey)&&CKEDITOR.tools.setTimeout(function(){t.addFillers(n)||t.removeFillers(n)},0)},null,null,-1),e.on("selectionCheck",function(e){t.removeFillers(e.editor.editable())}),e.on("paste",function(e){e.data.dataValue=t.cleanPasteData(e.data.dataValue)}),"selectall"in e.plugins&&t.addSelectAllIntegration(e)})}}}),CKEDITOR.plugins.widgetselection={startFiller:null,endFiller:null,fillerAttribute:"data-cke-filler-webkit",fillerContent:"&nbsp;",fillerTagName:"div",addFillers:function(t){var i=t.editor;if(!this.isWholeContentSelected(t)&&0<t.getChildCount()){var n=t.getFirst(e),a=t.getLast(e);if(n&&n.type==CKEDITOR.NODE_ELEMENT&&!n.isEditable()&&(this.startFiller=this.createFiller(),t.append(this.startFiller,1)),a&&a.type==CKEDITOR.NODE_ELEMENT&&!a.isEditable()&&(this.endFiller=this.createFiller(!0),t.append(this.endFiller,0)),this.hasFiller(t))return i=i.createRange(),i.selectNodeContents(t),i.select(),!0}return!1},removeFillers:function(e){if(this.hasFiller(e)&&!this.isWholeContentSelected(e)){var t=e.findOne(this.fillerTagName+"["+this.fillerAttribute+"=start]"),i=e.findOne(this.fillerTagName+"["+this.fillerAttribute+"=end]");this.startFiller&&t&&this.startFiller.equals(t)?this.removeFiller(this.startFiller,e):this.startFiller=t,this.endFiller&&i&&this.endFiller.equals(i)?this.removeFiller(this.endFiller,e):this.endFiller=i}},cleanPasteData:function(e){return e&&e.length&&(e=e.replace(this.createFillerRegex(),"").replace(this.createFillerRegex(!0),"")),e},isWholeContentSelected:function(e){var t=e.editor.getSelection().getRanges()[0];return!(!t||t&&t.collapsed)&&(t=t.clone(),t.enlarge(CKEDITOR.ENLARGE_ELEMENT),!!(t&&e&&t.startContainer&&t.endContainer&&0===t.startOffset&&t.endOffset===e.getChildCount()&&t.startContainer.equals(e)&&t.endContainer.equals(e)))},hasFiller:function(e){return 0<e.find(this.fillerTagName+"["+this.fillerAttribute+"]").count()},createFiller:function(e){var t=new CKEDITOR.dom.element(this.fillerTagName);return t.setHtml(this.fillerContent),t.setAttribute(this.fillerAttribute,e?"end":"start"),t.setAttribute("data-cke-temp",1),t.setStyles({display:"block",width:0,height:0,padding:0,border:0,margin:0,position:"absolute",top:0,left:"-9999px",opacity:0,overflow:"hidden"}),t},removeFiller:function(e,t){if(e){var i,n,a=t.editor,s=t.editor.getSelection().getRanges()[0].startPath(),o=a.createRange();s.contains(e)&&(i=e.getHtml(),n=!0),s="start"==e.getAttribute(this.fillerAttribute),e.remove(),i&&0<i.length&&i!=this.fillerContent?(t.insertHtmlIntoRange(i,a.getSelection().getRanges()[0]),o.setStartAt(t.getChild(t.getChildCount()-1),CKEDITOR.POSITION_BEFORE_END),a.getSelection().selectRanges([o])):n&&(s?o.setStartAt(t.getFirst().getNext(),CKEDITOR.POSITION_AFTER_START):o.setEndAt(t.getLast().getPrevious(),CKEDITOR.POSITION_BEFORE_END),t.editor.getSelection().selectRanges([o]))}},createFillerRegex:function(e){var t=this.createFiller(e).getOuterHtml().replace(/style="[^"]*"/gi,'style="[^"]*"').replace(/>[^<]*</gi,">[^<]*<");return new RegExp((e?"":"^")+t+(e?"$":""))},addSelectAllIntegration:function(e){var t=this;e.editable().attachListener(e,"beforeCommandExec",function(i){var n=e.editable();"selectAll"==i.data.name&&n&&t.addFillers(n)},null,null,9999)}}}(),CKEDITOR.plugins.add("notification",{lang:"az,ca,cs,da,de,de-ch,en,eo,es,eu,fr,gl,id,it,ja,km,ko,ku,nb,nl,oc,pl,pt,pt-br,ru,sv,tr,ug,uk,zh,zh-cn",requires:"toolbar",init:function(e){function t(e){var t=new CKEDITOR.dom.element("div");t.setStyles({position:"fixed","margin-left":"-9999px"}),t.setAttributes({"aria-live":"assertive","aria-atomic":"true"}),t.setText(e),CKEDITOR.document.getBody().append(t),setTimeout(function(){t.remove()},100)}e._.notificationArea=new Area(e),e.showNotification=function(t,i,n){var a,s;return"progress"==i?a=n:s=n,t=new CKEDITOR.plugins.notification(e,{message:t,type:i,progress:a,duration:s}),t.show(),t},e.on("key",function(i){if(27==i.data.keyCode){var n=e._.notificationArea.notifications;n.length&&(t(e.lang.notification.closed),n[n.length-1].hide(),i.cancel())}})}}),Notification.prototype={show:function(){!1!==this.editor.fire("notificationShow",{notification:this})&&(this.area.add(this),this._hideAfterTimeout())},update:function(e){var t=!0;!1===this.editor.fire("notificationUpdate",{notification:this,options:e})&&(t=!1);var i=this.element,n=i.findOne(".cke_notification_message"),a=i.findOne(".cke_notification_progress"),s=e.type;i.removeAttribute("role"),e.progress&&"progress"!=this.type&&(s="progress"),s&&(i.removeClass(this._getClass()),i.removeAttribute("aria-label"),this.type=s,i.addClass(this._getClass()),i.setAttribute("aria-label",this.type),"progress"!=this.type||a?"progress"!=this.type&&a&&a.remove():(a=this._createProgressElement(),a.insertBefore(n))),void 0!==e.message&&(this.message=e.message,n.setHtml(this.message)),void 0!==e.progress&&(this.progress=e.progress,a&&a.setStyle("width",this._getPercentageProgress())),t&&e.important&&(i.setAttribute("role","alert"),this.isVisible()||this.area.add(this)),this.duration=e.duration,this._hideAfterTimeout()},hide:function(){!1!==this.editor.fire("notificationHide",{notification:this})&&this.area.remove(this)},isVisible:function(){return 0<=CKEDITOR.tools.indexOf(this.area.notifications,this)},_createElement:function(){var e,t,i=this,n=this.editor.lang.common.close;return e=new CKEDITOR.dom.element("div"),e.addClass("cke_notification"),e.addClass(this._getClass()),e.setAttributes({id:this.id,role:"alert","aria-label":this.type}),"progress"==this.type&&e.append(this._createProgressElement()),t=new CKEDITOR.dom.element("p"),t.addClass("cke_notification_message"),t.setHtml(this.message),e.append(t),t=CKEDITOR.dom.element.createFromHtml('<a class="cke_notification_close" href="javascript:void(0)" title="'+n+'" role="button" tabindex="-1"><span class="cke_label">X</span></a>'),e.append(t),t.on("click",function(){i.editor.focus(),i.hide()}),e},_getClass:function(){return"progress"==this.type?"cke_notification_info":"cke_notification_"+this.type},_createProgressElement:function(){var e=new CKEDITOR.dom.element("span");return e.addClass("cke_notification_progress"),e.setStyle("width",this._getPercentageProgress()),e},_getPercentageProgress:function(){return Math.round(100*(this.progress||0))+"%"},_hideAfterTimeout:function(){var e,t=this;this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),"number"==typeof this.duration?e=this.duration:"info"!=this.type&&"success"!=this.type||(e="number"==typeof this.editor.config.notification_duration?this.editor.config.notification_duration:5e3),e&&(t._hideTimeoutId=setTimeout(function(){t.hide()},e))}},Area.prototype={add:function(e){this.notifications.push(e),this.element.append(e.element),1==this.element.getChildCount()&&(CKEDITOR.document.getBody().append(this.element),this._attachListeners()),this._layout()},remove:function(e){var t=CKEDITOR.tools.indexOf(this.notifications,e);0>t||(this.notifications.splice(t,1),e.element.remove(),this.element.getChildCount()||(this._removeListeners(),this.element.remove()))},_createElement:function(){var e=this.editor,t=e.config,i=new CKEDITOR.dom.element("div");return i.addClass("cke_notifications_area"),i.setAttribute("id","cke_notifications_area_"+e.name),i.setStyle("z-index",t.baseFloatZIndex-2),i},_attachListeners:function(){var e=CKEDITOR.document.getWindow(),t=this.editor;e.on("scroll",this._uiBuffer.input),e.on("resize",this._uiBuffer.input),t.on("change",this._changeBuffer.input),t.on("floatingSpaceLayout",this._layout,this,null,20),t.on("blur",this._layout,this,null,20)},_removeListeners:function(){var e=CKEDITOR.document.getWindow(),t=this.editor;e.removeListener("scroll",this._uiBuffer.input),e.removeListener("resize",this._uiBuffer.input),t.removeListener("change",this._changeBuffer.input),t.removeListener("floatingSpaceLayout",this._layout),t.removeListener("blur",this._layout)},_layout:function(){function e(){i.setStyle("left",g(f+a.width-l-d))}var t,i=this.element,n=this.editor,a=n.ui.contentsElement.getClientRect(),s=n.ui.contentsElement.getDocumentPosition(),n=n.ui.space("top"),o=n.getClientRect(),r=i.getClientRect(),l=this._notificationWidth,d=this._notificationMargin;t=CKEDITOR.document.getWindow();var c=t.getScrollPosition(),u=t.getViewPaneSize(),h=CKEDITOR.document.getBody(),p=h.getDocumentPosition(),g=CKEDITOR.tools.cssLength;l&&d||(t=this.element.getChild(0),l=this._notificationWidth=t.getClientRect().width,d=this._notificationMargin=parseInt(t.getComputedStyle("margin-left"),10)+parseInt(t.getComputedStyle("margin-right"),10)),n.isVisible()&&o.bottom>a.top&&o.bottom<a.bottom-r.height?i.setStyles({position:"fixed",top:g(o.bottom)}):0<a.top?i.setStyles({position:"absolute",top:g(s.y)}):s.y+a.height-r.height>c.y?i.setStyles({position:"fixed",top:0}):i.setStyles({position:"absolute",top:g(s.y+a.height-r.height)});var f="fixed"==i.getStyle("position")?a.left:"static"!=h.getComputedStyle("position")?s.x-p.x:s.x;a.width<l+d?s.x+l+d>c.x+u.width?e():i.setStyle("left",g(f)):s.x+l+d>c.x+u.width?i.setStyle("left",g(f)):s.x+a.width/2+l/2+d>c.x+u.width?i.setStyle("left",g(f-s.x+c.x+u.width-l-d)):0>a.left+a.width-l-d?e():0>a.left+a.width/2-l/2?i.setStyle("left",g(f-s.x+c.x)):i.setStyle("left",g(f+a.width/2-l/2-d/2))}},CKEDITOR.plugins.notification=Notification,CKEDITOR.plugins.setLang("image2","zh-cn",{alt:"替换文本",btnUpload:"上传到服务器",captioned:"带标题图像",captionPlaceholder:"标题",infoTab:"图像信息",lockRatio:"锁定比例",menu:"图像属性",pathName:"图像",pathNameCaption:"标题",resetSize:"原始尺寸",resizer:"点击并拖拽以改变尺寸",title:"图像属性",uploadTab:"上传",urlMissing:"缺少图像源文件地址",altMissing:"缺少替换文本"}),CKEDITOR.plugins.setLang("uploadwidget","zh-cn",{abort:"上传已被用户中止",doneOne:"文件上传成功",doneMany:"成功上传了 %1 个文件",uploadOne:"正在上传文件（{percentage}%）...",uploadMany:"正在上传文件，{max} 中的 {current}（{percentage}%）..."}),CKEDITOR.plugins.setLang("widget","zh-cn",{move:"点击并拖拽以移动",label:"%1 小部件"}),CKEDITOR.plugins.setLang("filetools","zh-cn",{loadError:"读取文件时发生错误",networkError:"上传文件时发生网络错误",httpError404:"上传文件时发生 HTTP 错误（404：无法找到文件）",httpError403:"上传文件时发生 HTTP 错误（403：禁止访问）",httpError:"上传文件时发生 HTTP 错误（错误代码：%1）",noUrlError:"上传的 URL 未定义",responseError:"不正确的服务器响应"}),CKEDITOR.plugins.setLang("notification","zh-cn",{closed:"通知已关闭"});